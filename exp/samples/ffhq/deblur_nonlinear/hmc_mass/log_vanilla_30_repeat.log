nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
epoch 1 PSNR: 16.473464965820312 sigma_y: 1.0 tau: 1.0
epoch 2 PSNR: 18.288890838623047 sigma_y: 1.0 tau: 1.0
epoch 3 PSNR: 20.821125030517578 sigma_y: 1.0 tau: 1.0
epoch 4 PSNR: 21.75507354736328 sigma_y: 1.0 tau: 1.0
epoch 5 PSNR: 23.371601104736328 sigma_y: 1.0 tau: 0.95
epoch 6 PSNR: 24.589881896972656 sigma_y: 1.0 tau: 0.9025
epoch 7 PSNR: 25.720109939575195 sigma_y: 0.9129666666666666 tau: 0.9025
epoch 8 PSNR: 26.146221160888672 sigma_y: 0.8317333333333334 tau: 0.8573749999999999
epoch 9 PSNR: 26.285442352294922 sigma_y: 0.7561000000000001 tau: 0.7737809374999999
epoch 10 PSNR: 26.37763786315918 sigma_y: 0.6858666666666667 tau: 0.7350918906249998
epoch 11 PSNR: 27.015186309814453 sigma_y: 0.6208333333333335 tau: 0.6983372960937497
epoch 12 PSNR: 27.095088958740234 sigma_y: 0.5608000000000001 tau: 0.6634204312890623
epoch 13 PSNR: 27.59010124206543 sigma_y: 0.5055666666666666 tau: 0.5987369392383786
epoch 14 PSNR: 27.50345230102539 sigma_y: 0.4549333333333334 tau: 0.48767497911552943
epoch 15 PSNR: 27.469472885131836 sigma_y: 0.40869999999999995 tau: 0.44012666865176525
epoch 16 PSNR: 27.791770935058594 sigma_y: 0.3666666666666668 tau: 0.3972143184582181
epoch 17 PSNR: 27.896827697753906 sigma_y: 0.32863333333333333 tau: 0.34056162628811465
epoch 18 PSNR: 28.021385192871094 sigma_y: 0.2944 tau: 0.2919890243387723
epoch 19 PSNR: 27.946754455566406 sigma_y: 0.26376666666666665 tau: 0.27738957312183365
epoch 20 PSNR: 28.172014236450195 sigma_y: 0.23653333333333335 tau: 0.27738957312183365
epoch 21 PSNR: 28.32695770263672 sigma_y: 0.21250000000000002 tau: 0.2378268852553321
epoch 22 PSNR: 28.385725021362305 sigma_y: 0.19146666666666667 tau: 0.18402591023557577
epoch 23 PSNR: 28.501625061035156 sigma_y: 0.17323333333333335 tau: 0.17482461472379698
epoch 24 PSNR: 28.66512107849121 sigma_y: 0.15760000000000002 tau: 0.14239574134637464
epoch 25 PSNR: 28.667476654052734 sigma_y: 0.1443666666666667 tau: 0.1285121565651031
epoch 26 PSNR: 28.82701873779297 sigma_y: 0.13333333333333336 tau: 0.1285121565651031
epoch 27 PSNR: 28.838260650634766 sigma_y: 0.12430000000000002 tau: 0.08974483193085074
epoch 28 PSNR: 28.8747615814209 sigma_y: 0.11706666666666668 tau: 0.08974483193085074
epoch 29 PSNR: 28.929161071777344 sigma_y: 0.11143333333333333 tau: 0.08974483193085074
epoch 30 PSNR: 28.946945190429688 sigma_y: 0.1072 tau: 0.08974483193085074
epoch 31 PSNR: 29.02125358581543 sigma_y: 0.1 tau: 0.08974483193085074
epoch 32 PSNR: 29.018051147460938 sigma_y: 0.1 tau: 0.08974483193085074
epoch 33 PSNR: 29.080169677734375 sigma_y: 0.1 tau: 0.08974483193085074
epoch 34 PSNR: 29.07916831970215 sigma_y: 0.1 tau: 0.0852575903343082
epoch 35 PSNR: 29.091102600097656 sigma_y: 0.1 tau: 0.07309772651287748
epoch 36 PSNR: 29.066438674926758 sigma_y: 0.1 tau: 0.07309772651287748
epoch 37 PSNR: 29.12310028076172 sigma_y: 0.1 tau: 0.0626721632689783
epoch 38 PSNR: 29.100147247314453 sigma_y: 0.1 tau: 0.0626721632689783
epoch 39 PSNR: 29.112117767333984 sigma_y: 0.1 tau: 0.0626721632689783
epoch 40 PSNR: 29.13852882385254 sigma_y: 0.1 tau: 0.0626721632689783
epoch 41 PSNR: 29.1666316986084 sigma_y: 0.1 tau: 0.0626721632689783
epoch 42 PSNR: 29.159337997436523 sigma_y: 0.1 tau: 0.0626721632689783
epoch 43 PSNR: 29.186288833618164 sigma_y: 0.1 tau: 0.0626721632689783
epoch 44 PSNR: 29.18356704711914 sigma_y: 0.1 tau: 0.0626721632689783
epoch 45 PSNR: 29.233015060424805 sigma_y: 0.1 tau: 0.0626721632689783
epoch 46 PSNR: 29.20391082763672 sigma_y: 0.1 tau: 0.0626721632689783
epoch 47 PSNR: 29.266803741455078 sigma_y: 0.1 tau: 0.0626721632689783
epoch 48 PSNR: 29.2645263671875 sigma_y: 0.1 tau: 0.0626721632689783
epoch 49 PSNR: 29.232027053833008 sigma_y: 0.1 tau: 0.05656162735025291
epoch 50 PSNR: 29.19227409362793 sigma_y: 0.1 tau: 0.05656162735025291
epoch 51 PSNR: 29.2282772064209 sigma_y: 0.1 tau: 0.05656162735025291
epoch 52 PSNR: 29.220985412597656 sigma_y: 0.1 tau: 0.05656162735025291
epoch 53 PSNR: 29.264352798461914 sigma_y: 0.1 tau: 0.05656162735025291
epoch 54 PSNR: 29.253332138061523 sigma_y: 0.1 tau: 0.05656162735025291
epoch 55 PSNR: 29.251724243164062 sigma_y: 0.1 tau: 0.05656162735025291
epoch 56 PSNR: 29.229764938354492 sigma_y: 0.1 tau: 0.05656162735025291
epoch 57 PSNR: 29.259765625 sigma_y: 0.1 tau: 0.053733545982740265
epoch 58 PSNR: 29.264293670654297 sigma_y: 0.1 tau: 0.053733545982740265
epoch 59 PSNR: 29.277658462524414 sigma_y: 0.1 tau: 0.053733545982740265
epoch 60 PSNR: 29.32025146484375 sigma_y: 0.1 tau: 0.053733545982740265
epoch 61 PSNR: 29.335708618164062 sigma_y: 0.1 tau: 0.053733545982740265
epoch 62 PSNR: 29.312150955200195 sigma_y: 0.1 tau: 0.053733545982740265
epoch 63 PSNR: 29.357240676879883 sigma_y: 0.1 tau: 0.053733545982740265
epoch 64 PSNR: 29.31604766845703 sigma_y: 0.1 tau: 0.053733545982740265
epoch 65 PSNR: 29.351167678833008 sigma_y: 0.1 tau: 0.053733545982740265
epoch 66 PSNR: 29.326078414916992 sigma_y: 0.1 tau: 0.053733545982740265
epoch 67 PSNR: 29.378101348876953 sigma_y: 0.1 tau: 0.053733545982740265
epoch 68 PSNR: 29.338619232177734 sigma_y: 0.1 tau: 0.053733545982740265
epoch 69 PSNR: 29.399253845214844 sigma_y: 0.1 tau: 0.053733545982740265
epoch 70 PSNR: 29.299753189086914 sigma_y: 0.1 tau: 0.053733545982740265
epoch 71 PSNR: 29.353883743286133 sigma_y: 0.1 tau: 0.053733545982740265
epoch 72 PSNR: 29.36161231994629 sigma_y: 0.1 tau: 0.053733545982740265
epoch 73 PSNR: 29.42003059387207 sigma_y: 0.1 tau: 0.053733545982740265
epoch 74 PSNR: 29.4240665435791 sigma_y: 0.1 tau: 0.053733545982740265
epoch 75 PSNR: 29.457592010498047 sigma_y: 0.1 tau: 0.053733545982740265
main_sampling.py:521: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  LPIPS = loss_fn_vgg(2*orig-1.0, 2*torch.tensor(x[j]).to(torch.float32).cuda()-1.0)[0,0,0,0]
PSNR:29.2883 (0.0776), SSIM:0.79601 (0.00198), LPIPS:0.24782 (0.00222):   0%|          | 0/100 [09:41<?, ?it/s]PSNR:29.2883 (0.0776), SSIM:0.79601 (0.00198), LPIPS:0.24782 (0.00222):   1%|          | 1/100 [09:41<15:59:04, 581.26s/it]epoch 1 PSNR: 17.201335906982422 sigma_y: 1.0 tau: 0.8573749999999999
epoch 2 PSNR: 17.559677124023438 sigma_y: 1.0 tau: 0.8573749999999999
epoch 3 PSNR: 18.74498748779297 sigma_y: 1.0 tau: 0.8573749999999999
epoch 4 PSNR: 19.59024429321289 sigma_y: 1.0 tau: 0.8573749999999999
epoch 5 PSNR: 21.455080032348633 sigma_y: 1.0 tau: 0.8573749999999999
epoch 6 PSNR: 22.329500198364258 sigma_y: 1.0 tau: 0.8573749999999999
epoch 7 PSNR: 23.416040420532227 sigma_y: 0.9129666666666666 tau: 0.8573749999999999
epoch 8 PSNR: 23.97486686706543 sigma_y: 0.8317333333333334 tau: 0.8573749999999999
epoch 9 PSNR: 24.687593460083008 sigma_y: 0.7561000000000001 tau: 0.8573749999999999
epoch 10 PSNR: 25.23137855529785 sigma_y: 0.6858666666666667 tau: 0.8573749999999999
epoch 11 PSNR: 25.13320541381836 sigma_y: 0.6208333333333335 tau: 0.8573749999999999
epoch 12 PSNR: 25.60962677001953 sigma_y: 0.5608000000000001 tau: 0.8573749999999999
epoch 13 PSNR: 26.010112762451172 sigma_y: 0.5055666666666666 tau: 0.8573749999999999
epoch 14 PSNR: 25.941036224365234 sigma_y: 0.4549333333333334 tau: 0.7350918906249998
epoch 15 PSNR: 26.08802604675293 sigma_y: 0.40869999999999995 tau: 0.6983372960937497
epoch 16 PSNR: 26.24941062927246 sigma_y: 0.3666666666666668 tau: 0.5987369392383786
epoch 17 PSNR: 26.341848373413086 sigma_y: 0.32863333333333333 tau: 0.48767497911552943
epoch 18 PSNR: 26.576478958129883 sigma_y: 0.2944 tau: 0.48767497911552943
epoch 19 PSNR: 26.597881317138672 sigma_y: 0.26376666666666665 tau: 0.41812033521917696
epoch 20 PSNR: 26.92090606689453 sigma_y: 0.23653333333333335 tau: 0.3972143184582181
epoch 21 PSNR: 26.923532485961914 sigma_y: 0.21250000000000002 tau: 0.35848592240854177
epoch 22 PSNR: 27.107070922851562 sigma_y: 0.19146666666666667 tau: 0.2919890243387723
epoch 23 PSNR: 27.213542938232422 sigma_y: 0.17323333333333335 tau: 0.2919890243387723
epoch 24 PSNR: 27.41866111755371 sigma_y: 0.15760000000000002 tau: 0.2378268852553321
epoch 25 PSNR: 27.468780517578125 sigma_y: 0.1443666666666667 tau: 0.2378268852553321
epoch 26 PSNR: 27.635419845581055 sigma_y: 0.13333333333333336 tau: 0.2378268852553321
epoch 27 PSNR: 27.678417205810547 sigma_y: 0.12430000000000002 tau: 0.1937114844585008
epoch 28 PSNR: 27.82394790649414 sigma_y: 0.11706666666666668 tau: 0.18402591023557577
epoch 29 PSNR: 27.828340530395508 sigma_y: 0.11143333333333333 tau: 0.18402591023557577
epoch 30 PSNR: 27.95581817626953 sigma_y: 0.1072 tau: 0.18402591023557577
epoch 31 PSNR: 28.006587982177734 sigma_y: 0.1 tau: 0.08145062499999998
epoch 32 PSNR: 28.053142547607422 sigma_y: 0.1 tau: 0.08145062499999998
epoch 33 PSNR: 28.118083953857422 sigma_y: 0.1 tau: 0.07737809374999999
epoch 34 PSNR: 28.22688102722168 sigma_y: 0.1 tau: 0.07737809374999999
epoch 35 PSNR: 28.223159790039062 sigma_y: 0.1 tau: 0.07737809374999999
epoch 36 PSNR: 28.304330825805664 sigma_y: 0.1 tau: 0.07737809374999999
epoch 37 PSNR: 28.379762649536133 sigma_y: 0.1 tau: 0.07350918906249998
epoch 38 PSNR: 28.408897399902344 sigma_y: 0.1 tau: 0.07350918906249998
epoch 39 PSNR: 28.479198455810547 sigma_y: 0.1 tau: 0.05403600876626367
epoch 40 PSNR: 28.480566024780273 sigma_y: 0.1 tau: 0.05403600876626367
epoch 41 PSNR: 28.470516204833984 sigma_y: 0.1 tau: 0.05133420832795048
epoch 42 PSNR: 28.455833435058594 sigma_y: 0.1 tau: 0.05133420832795048
epoch 43 PSNR: 28.483257293701172 sigma_y: 0.1 tau: 0.05133420832795048
epoch 44 PSNR: 28.488433837890625 sigma_y: 0.1 tau: 0.05133420832795048
epoch 45 PSNR: 28.473819732666016 sigma_y: 0.1 tau: 0.05133420832795048
epoch 46 PSNR: 28.528152465820312 sigma_y: 0.1 tau: 0.05133420832795048
epoch 47 PSNR: 28.477848052978516 sigma_y: 0.1 tau: 0.05133420832795048
epoch 48 PSNR: 28.540258407592773 sigma_y: 0.1 tau: 0.05133420832795048
epoch 49 PSNR: 28.50369644165039 sigma_y: 0.1 tau: 0.05133420832795048
epoch 50 PSNR: 28.477466583251953 sigma_y: 0.1 tau: 0.05133420832795048
epoch 51 PSNR: 28.424484252929688 sigma_y: 0.1 tau: 0.05133420832795048
epoch 52 PSNR: 28.469982147216797 sigma_y: 0.1 tau: 0.05133420832795048
epoch 53 PSNR: 28.4958553314209 sigma_y: 0.1 tau: 0.05133420832795048
epoch 54 PSNR: 28.515186309814453 sigma_y: 0.1 tau: 0.05133420832795048
epoch 55 PSNR: 28.469295501708984 sigma_y: 0.1 tau: 0.046329123015975304
epoch 56 PSNR: 28.489171981811523 sigma_y: 0.1 tau: 0.046329123015975304
epoch 57 PSNR: 28.48253059387207 sigma_y: 0.1 tau: 0.04181203352191771
epoch 58 PSNR: 28.51763916015625 sigma_y: 0.1 tau: 0.04181203352191771
epoch 59 PSNR: 28.523773193359375 sigma_y: 0.1 tau: 0.04181203352191771
epoch 60 PSNR: 28.52608871459961 sigma_y: 0.1 tau: 0.04181203352191771
epoch 61 PSNR: 28.5446834564209 sigma_y: 0.1 tau: 0.04181203352191771
epoch 62 PSNR: 28.509004592895508 sigma_y: 0.1 tau: 0.04181203352191771
epoch 63 PSNR: 28.499744415283203 sigma_y: 0.1 tau: 0.04181203352191771
epoch 64 PSNR: 28.506906509399414 sigma_y: 0.1 tau: 0.04181203352191771
epoch 65 PSNR: 28.479005813598633 sigma_y: 0.1 tau: 0.04181203352191771
epoch 66 PSNR: 28.512134552001953 sigma_y: 0.1 tau: 0.04181203352191771
epoch 67 PSNR: 28.53590202331543 sigma_y: 0.1 tau: 0.04181203352191771
epoch 68 PSNR: 28.566707611083984 sigma_y: 0.1 tau: 0.04181203352191771
epoch 69 PSNR: 28.551986694335938 sigma_y: 0.1 tau: 0.04181203352191771
epoch 70 PSNR: 28.53243064880371 sigma_y: 0.1 tau: 0.04181203352191771
epoch 71 PSNR: 28.584815979003906 sigma_y: 0.1 tau: 0.04181203352191771
epoch 72 PSNR: 28.64488410949707 sigma_y: 0.1 tau: 0.04181203352191771
epoch 73 PSNR: 28.615726470947266 sigma_y: 0.1 tau: 0.04181203352191771
epoch 74 PSNR: 28.607046127319336 sigma_y: 0.1 tau: 0.039721431845821824
epoch 75 PSNR: 28.595779418945312 sigma_y: 0.1 tau: 0.039721431845821824
PSNR:28.9027 (0.0632), SSIM:0.82848 (0.00186), LPIPS:0.20722 (0.00212):   1%|          | 1/100 [18:47<15:59:04, 581.26s/it]PSNR:28.9027 (0.0632), SSIM:0.82848 (0.00186), LPIPS:0.20722 (0.00212):   2%|▏         | 2/100 [18:47<15:15:54, 560.76s/it]epoch 1 PSNR: 15.080135345458984 sigma_y: 1.0 tau: 0.6302494097246091
epoch 2 PSNR: 14.89414119720459 sigma_y: 1.0 tau: 0.5987369392383786
epoch 3 PSNR: 15.537799835205078 sigma_y: 1.0 tau: 0.5987369392383786
epoch 4 PSNR: 16.381052017211914 sigma_y: 1.0 tau: 0.5688000922764596
epoch 5 PSNR: 17.512948989868164 sigma_y: 1.0 tau: 0.5133420832795047
epoch 6 PSNR: 17.357696533203125 sigma_y: 1.0 tau: 0.3972143184582181
epoch 7 PSNR: 17.803699493408203 sigma_y: 0.9129666666666666 tau: 0.3972143184582181
epoch 8 PSNR: 18.131359100341797 sigma_y: 0.8317333333333334 tau: 0.3235335449737089
epoch 9 PSNR: 18.318326950073242 sigma_y: 0.7561000000000001 tau: 0.30735686772502346
epoch 10 PSNR: 18.28012466430664 sigma_y: 0.6858666666666667 tau: 0.263520094465742
epoch 11 PSNR: 18.478046417236328 sigma_y: 0.6208333333333335 tau: 0.25034408974245487
epoch 12 PSNR: 18.49795150756836 sigma_y: 0.5608000000000001 tau: 0.25034408974245487
epoch 13 PSNR: 18.821928024291992 sigma_y: 0.5055666666666666 tau: 0.25034408974245487
epoch 14 PSNR: 19.045795440673828 sigma_y: 0.4549333333333334 tau: 0.25034408974245487
epoch 15 PSNR: 18.939861297607422 sigma_y: 0.40869999999999995 tau: 0.1937114844585008
epoch 16 PSNR: 19.253334045410156 sigma_y: 0.3666666666666668 tau: 0.1937114844585008
epoch 17 PSNR: 19.203657150268555 sigma_y: 0.32863333333333333 tau: 0.1937114844585008
epoch 18 PSNR: 19.391220092773438 sigma_y: 0.2944 tau: 0.1937114844585008
epoch 19 PSNR: 19.455059051513672 sigma_y: 0.26376666666666665 tau: 0.16608338398760714
epoch 20 PSNR: 19.567556381225586 sigma_y: 0.23653333333333335 tau: 0.16608338398760714
epoch 21 PSNR: 19.708309173583984 sigma_y: 0.21250000000000002 tau: 0.16608338398760714
epoch 22 PSNR: 19.54956817626953 sigma_y: 0.19146666666666667 tau: 0.14989025404881542
PSNR:28.9027 (0.0632), SSIM:0.82848 (0.00186), LPIPS:0.20722 (0.00212):   2%|▏         | 2/100 [23:08<18:54:06, 694.35s/it]
Traceback (most recent call last):
  File "main_sampling.py", line 1040, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 836, in hmc
    xt = iterative_sampling(x_proposal, n, b, seq, seq_next, algo, opt, y_0, tqdm_disable=True).clip(-1, 1)
  File "main_sampling.py", line 902, in iterative_sampling
    t = (torch.ones(n) * i).to(xt.device)
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 789094) is killed by signal: Terminated. 
