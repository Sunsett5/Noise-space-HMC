nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
M_diag tensor([0.2500, 2.6906, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.8482, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.8548, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000,
        0.2500, 4.0000, 1.0558, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        1.1296, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.4874,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.4461, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 0.3008, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 1.8177, 0.2500, 0.2500, 0.2500, 0.2500, 0.2513, 4.0000, 0.4362,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500,
        0.2654, 0.4461, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        2.4742, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 1.4670, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2548, 0.2500,
        4.0000, 4.0000, 4.0000, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 0.3466,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 1 PSNR: 15.638495445251465 sigma_y: 1.7000000000000002 tau: 1.0
M_diag tensor([0.2500, 0.2500, 4.0000, 3.3360, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.4838,
        0.2500, 0.2500, 2.6701, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.5577, 0.2500, 0.5672,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 1.4040, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 1.6685, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 1.0151, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500,
        4.0000, 0.2919, 0.2500, 2.1501, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 3.0325, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 3.1698, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500,
        4.0000, 0.4314, 0.8815, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.4045,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 2.3342, 0.2500, 0.2500,
        0.2500, 4.0000, 2.7967, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.6537,
        0.2500, 0.2500, 0.2500, 4.0000, 1.2573, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 3.7459, 4.0000, 0.2500,
        0.2500, 2.0254, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.3017, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 1.5744, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 1.5662, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.0969,
        0.2500, 0.2500, 4.0000, 0.3045, 0.2500, 0.5278, 4.0000, 4.0000, 0.5308,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 4.0000, 4.0000, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 2.5257, 4.0000], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 2 PSNR: 19.332672119140625 sigma_y: 1.6471111111111112 tau: 0.9025
M_diag tensor([0.4692, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 2.3773, 0.2500, 0.2500, 0.7594, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 2.2257, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 1.6142, 0.6240, 4.0000, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 1.0188, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 2.8592, 0.2500, 0.2500,
        0.2500, 1.8412, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500,
        0.2500, 2.8926, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.4423,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 2.1965, 0.5004, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 2.6884, 0.2500,
        4.0000, 2.9363, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 2.6898, 0.2500,
        4.0000, 3.3017, 4.0000, 0.2500, 0.5248, 0.2500, 0.2500, 0.2500, 4.0000,
        1.3329, 0.4419, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.6435, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.4185, 4.0000, 4.0000, 4.0000,
        4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 1.2380, 0.2500, 0.2500,
        0.2500, 0.2500, 3.8686, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        1.6111, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.3489, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 3 PSNR: 20.263784408569336 sigma_y: 1.5951111111111111 tau: 0.8145062499999999
M_diag tensor([0.5718, 4.0000, 4.0000, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 3.2557, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 1.8343, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.4311, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.7228, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 1.0017, 0.3930, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.3478, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.4272, 0.2500, 0.2500, 0.2500, 3.7440,
        0.2500, 0.2500, 0.2500, 3.2712, 0.2500, 0.2500, 0.2500, 0.4049, 1.5303,
        0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 1.8558, 4.0000, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.3286, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.4915, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        4.0000, 1.1626, 0.2500, 0.2500, 0.2677, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.6983, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 1.4899, 0.2500, 4.0000], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 4 PSNR: 22.001192092895508 sigma_y: 1.544 tau: 0.8145062499999999
M_diag tensor([4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 2.1777, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 4.0000, 4.0000, 2.5965, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 1.0016, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 2.3452, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.3108, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.3782, 1.8089, 0.2500,
        2.4135, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 1.3507, 0.4735, 1.0732, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.4153, 0.2500, 0.2500, 0.2500,
        2.6754, 4.0000, 0.2765, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 1.0361, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 1.0498, 0.2500, 4.0000, 0.2500, 0.2500, 0.7932, 3.2261, 0.2500,
        4.0000, 0.9464, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2890, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.6107, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.6351, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 1.2069, 0.2500, 0.2500, 0.2500, 4.0000, 0.3927,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000,
        1.2762, 0.2500, 0.2500, 0.2500, 0.2500, 0.3667, 0.9272, 0.2500, 4.0000,
        0.3440, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 1.3327, 0.2500, 0.4834, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 5 PSNR: 23.219335556030273 sigma_y: 1.493777777777778 tau: 0.8145062499999999
M_diag tensor([0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.3794, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.4829, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.3841, 0.2500, 0.3186, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.4305, 0.6389, 2.2034, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.5030, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.6010, 3.8156, 0.2500, 0.9593,
        0.2500, 0.2500, 0.2500, 0.9595, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.4377, 3.3148, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2707,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 1.5363, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 1.8967, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000,
        4.0000, 0.6472, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        1.3110, 0.2500, 4.0000, 2.3159, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 2.8562, 0.2500, 0.2500, 4.0000, 0.4305, 4.0000, 0.2500, 4.0000,
        0.9619, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 1.5037, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.6530, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.3767, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 6 PSNR: 23.672449111938477 sigma_y: 1.4444444444444444 tau: 0.8145062499999999
M_diag tensor([0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.7833,
        0.2670, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.3728, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.3752, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 3.4247, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 3.3190,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.6525, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 3.2630, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.7743, 4.0000, 4.0000, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.9407, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 2.3625, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.3796, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        1.0940, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.9324, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.7870, 4.0000,
        4.0000, 0.3732, 4.0000, 4.0000, 0.2575, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 3.7211, 1.1659, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 3.9025, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 7 PSNR: 23.950462341308594 sigma_y: 1.3960000000000004 tau: 0.6983372960937497
M_diag tensor([4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 1.7947, 0.5316,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.2870, 0.2500, 1.4607,
        4.0000, 0.2500, 4.0000, 1.0059, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.3931, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.8603,
        0.2500, 0.2500, 0.2542, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.4199,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        0.2500, 1.0330, 0.2500, 0.5142, 0.2500, 0.9899, 0.2537, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.3534, 0.2500,
        0.3923, 0.2500, 0.2500, 3.5375, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 4.0000,
        4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 1.5542, 4.0000, 0.2620,
        0.2500, 4.0000, 0.2500, 1.0414, 4.0000, 0.3013, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.7727, 0.2500, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.9677, 3.4830, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.3535, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 8 PSNR: 24.997798919677734 sigma_y: 1.3484444444444446 tau: 0.6983372960937497
M_diag tensor([0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.5196, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 3.9303, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 1.3977, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 1.5706, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 1.0075, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.5775, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 3.2012, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 1.2599, 1.7994, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.6915, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 1.4470, 4.0000, 0.4628, 0.2500,
        0.2500, 0.2500, 0.2500, 1.7384, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 4.0000, 1.2227, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.5803, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.3479, 2.3374, 4.0000,
        1.2528, 0.2500, 1.5780, 4.0000], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 9 PSNR: 25.166051864624023 sigma_y: 1.3017777777777781 tau: 0.6983372960937497
M_diag tensor([4.0000, 0.2500, 0.2500, 0.2500, 1.8340, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 1.4067, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.8811, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 1.6823,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.1080, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.4209, 0.4093, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.3323, 0.4154, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        4.0000, 0.3296, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.5990, 4.0000, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.4491, 4.0000, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 1.3846, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.7854, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.2930, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 1.8161, 4.0000, 4.0000, 4.0000, 4.0000, 0.2500,
        0.2500, 0.7970, 0.2500, 0.2500, 0.2500, 0.9752, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 2.6438,
        4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 1.0826, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 10 PSNR: 25.434532165527344 sigma_y: 1.256 tau: 0.5133420832795047
M_diag tensor([0.2500, 0.2500, 0.2500, 1.2109, 0.2500, 2.8097, 4.0000, 3.5449, 0.2500,
        0.2500, 0.2500, 0.2500, 0.3097, 0.2500, 0.7405, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.9409, 4.0000, 3.2079, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.8085, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 1.2510, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.5569, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.5555, 4.0000,
        4.0000, 0.2500, 0.7314, 0.2500, 4.0000, 0.5280, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.5282, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.3722, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2753, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.9206, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.8216, 0.2500, 0.2500,
        3.5952, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 1.8672,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.4668, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 3.4924, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.3789,
        2.0593, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 0.6217,
        0.2500, 0.2500, 0.2500, 1.5662, 0.2500, 2.4603, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.6756, 0.2500, 0.2835,
        0.2500, 4.0000, 0.2500, 4.0000], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 11 PSNR: 25.822017669677734 sigma_y: 1.2111111111111115 tau: 0.5133420832795047
M_diag tensor([0.2500, 0.3348, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 1.4372, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.1095,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        1.5595, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.6890, 0.2500,
        0.2500, 0.2500, 1.5352, 0.2500, 1.3518, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.7815, 0.2500, 0.2915, 4.0000, 4.0000, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 3.2178, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.3282, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.9396,
        0.2500, 0.2500, 0.2500, 1.9558, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 0.2926,
        4.0000, 0.7450, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 1.4719, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 3.4445, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.3936, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 1.1964, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 1.0620, 4.0000, 0.2500,
        0.2500, 2.0145, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 2.3851,
        1.8246, 4.0000, 0.2500, 0.3437, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 3.2828, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.5991, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.5574, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 12 PSNR: 26.09008026123047 sigma_y: 1.1671111111111112 tau: 0.5133420832795047
M_diag tensor([4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.3049, 1.9188, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2587, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.9679,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 1.0577, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.5231,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2688, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.3167, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 2.1089, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 1.0249, 4.0000, 0.2500, 0.2500, 0.2500, 0.4185,
        0.2500, 1.2774, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500,
        0.4957, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        1.4349, 4.0000, 0.2500, 0.4018, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.5467, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 1.5315, 0.2500, 0.2500,
        0.2500, 0.2500, 1.9020, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 13 PSNR: 26.00445556640625 sigma_y: 1.1240000000000003 tau: 0.5133420832795047
M_diag tensor([0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.5853, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        4.0000, 4.0000, 0.2500, 1.3836, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 1.8240, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2967, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 3.4114, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 2.2247, 0.2500, 4.0000, 0.2500, 0.2500, 1.7237,
        4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 4.0000, 0.6929, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 3.2654, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        3.5976, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.8552, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2860, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 0.3524, 1.9146, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2945, 4.0000, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000,
        1.8817, 4.0000, 0.2500, 3.7575, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500,
        0.2500, 4.0000, 0.9810, 0.2500, 4.0000, 0.9683, 0.2500, 0.2500, 0.2500,
        0.2828, 0.2500, 0.2500, 0.2500, 0.2500, 0.7815, 1.8226, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 14 PSNR: 25.89864730834961 sigma_y: 1.081777777777778 tau: 0.5133420832795047
M_diag tensor([0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 2.8183, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 2.4183, 0.2500, 0.2500, 1.0202,
        0.2500, 1.0222, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000,
        4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2881, 0.2500, 0.2500,
        0.2500, 0.2500, 3.6975, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2839,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2889,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.5076, 0.2500, 0.2500, 0.2500, 0.2500,
        0.3589, 4.0000, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.8813,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.5616, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.5954, 0.2500, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 2.5480, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 2.6644, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.7741, 0.2500,
        0.4752, 0.2500, 0.2500, 0.2500, 2.6704, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 1.0135], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 15 PSNR: 26.185157775878906 sigma_y: 1.0404444444444445 tau: 0.5133420832795047
M_diag tensor([4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.4832, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 0.4599, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.4679, 0.2500, 0.2500, 0.2500, 0.2500, 0.5005, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000,
        4.0000, 0.6822, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        4.0000, 2.5636, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 0.5491, 0.2500, 0.2500, 0.2500, 0.2500, 3.0074, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.5887, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.4732, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.2500, 1.1274, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 3.7658, 0.2500,
        0.2500, 1.2033, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000,
        0.2500, 0.9017, 0.2500, 0.2500, 0.5760, 0.2500, 1.1883, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 1.3011, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.9454, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        4.0000, 0.6206, 0.2500, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 16 PSNR: 26.046743392944336 sigma_y: 1.0 tau: 0.44012666865176525
M_diag tensor([0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.9711, 0.2500, 4.0000,
        0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 4.0000,
        4.0000, 4.0000, 0.2500, 0.3826, 0.2500, 0.2500, 0.2500, 0.2500, 1.2480,
        0.2500, 0.2500, 2.0558, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2529, 4.0000, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500,
        0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.3620, 0.2500, 4.0000, 0.4333, 0.2500, 4.0000, 0.2500,
        4.0000, 4.0000, 0.2500, 0.5158, 0.2500, 0.3163, 4.0000, 0.2500, 0.2608,
        0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.7357,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 2.4806, 0.2500, 0.2500,
        4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 4.0000, 0.2500, 2.9363,
        0.2500, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500, 2.3931, 0.2500, 0.2500,
        2.6901, 0.2500, 0.2500, 4.0000, 0.2500, 4.0000, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        4.0000, 4.0000, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500, 0.2500,
        0.2500, 0.2500, 4.0000, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward0>)
epoch 17 PSNR: 25.983436584472656 sigma_y: 0.9604444444444447 tau: 0.44012666865176525
  0%|          | 0/100 [03:38<?, ?it/s]
Traceback (most recent call last):
  File "main_sampling.py", line 1038, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 835, in hmc
    loss_grad = torch.autograd.grad(loss, x_proposal, retain_graph=False)[0]
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/__init__.py", line 436, in grad
    result = _engine_run_backward(
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 219223) is killed by signal: Terminated. 
