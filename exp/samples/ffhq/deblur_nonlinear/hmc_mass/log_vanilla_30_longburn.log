nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
epoch 1 PSNR: 16.484163284301758 sigma_y: 1.0 tau: 1.0
epoch 2 PSNR: 18.259002685546875 sigma_y: 1.0 tau: 1.0
epoch 3 PSNR: 20.24051284790039 sigma_y: 1.0 tau: 1.0
epoch 4 PSNR: 21.480941772460938 sigma_y: 1.0 tau: 0.8573749999999999
epoch 5 PSNR: 22.492277145385742 sigma_y: 1.0 tau: 0.7737809374999999
epoch 6 PSNR: 24.262392044067383 sigma_y: 1.0 tau: 0.7737809374999999
epoch 7 PSNR: 25.355018615722656 sigma_y: 1.0 tau: 0.7737809374999999
epoch 8 PSNR: 25.68850326538086 sigma_y: 1.0 tau: 0.7737809374999999
epoch 9 PSNR: 25.694400787353516 sigma_y: 1.0 tau: 0.7737809374999999
epoch 10 PSNR: 26.056617736816406 sigma_y: 1.0 tau: 0.7737809374999999
epoch 11 PSNR: 26.089191436767578 sigma_y: 1.0 tau: 0.7737809374999999
epoch 12 PSNR: 26.306964874267578 sigma_y: 1.0 tau: 0.7737809374999999
epoch 13 PSNR: 26.24873924255371 sigma_y: 1.0 tau: 0.7737809374999999
epoch 14 PSNR: 26.24922752380371 sigma_y: 1.0 tau: 0.7737809374999999
epoch 15 PSNR: 26.41767692565918 sigma_y: 1.0 tau: 0.7737809374999999
epoch 16 PSNR: 26.305553436279297 sigma_y: 1.0 tau: 0.7737809374999999
epoch 17 PSNR: 26.638195037841797 sigma_y: 0.9129666666666666 tau: 0.7737809374999999
epoch 18 PSNR: 26.511993408203125 sigma_y: 0.8317333333333334 tau: 0.7737809374999999
epoch 19 PSNR: 26.706541061401367 sigma_y: 0.7561000000000001 tau: 0.7737809374999999
epoch 20 PSNR: 27.065765380859375 sigma_y: 0.6858666666666667 tau: 0.7737809374999999
epoch 21 PSNR: 27.007122039794922 sigma_y: 0.6208333333333335 tau: 0.6302494097246091
epoch 22 PSNR: 27.522594451904297 sigma_y: 0.5608000000000001 tau: 0.6302494097246091
epoch 23 PSNR: 27.59515953063965 sigma_y: 0.5055666666666666 tau: 0.5403600876626365
epoch 24 PSNR: 27.527177810668945 sigma_y: 0.4549333333333334 tau: 0.48767497911552943
epoch 25 PSNR: 27.721176147460938 sigma_y: 0.40869999999999995 tau: 0.41812033521917696
epoch 26 PSNR: 28.018285751342773 sigma_y: 0.3666666666666668 tau: 0.37735360253530714
epoch 27 PSNR: 27.97042465209961 sigma_y: 0.32863333333333333 tau: 0.30735686772502346
epoch 28 PSNR: 28.279312133789062 sigma_y: 0.2944 tau: 0.30735686772502346
epoch 29 PSNR: 28.4726505279541 sigma_y: 0.26376666666666665 tau: 0.263520094465742
epoch 30 PSNR: 28.615745544433594 sigma_y: 0.23653333333333335 tau: 0.2146387639429372
epoch 31 PSNR: 28.769027709960938 sigma_y: 0.1 tau: 0.04876749791155295
epoch 32 PSNR: 28.882387161254883 sigma_y: 0.1 tau: 0.04876749791155295
epoch 33 PSNR: 28.960834503173828 sigma_y: 0.1 tau: 0.04876749791155295
epoch 34 PSNR: 29.063215255737305 sigma_y: 0.1 tau: 0.04401266686517654
epoch 35 PSNR: 29.0988826751709 sigma_y: 0.1 tau: 0.039721431845821824
epoch 36 PSNR: 29.09237289428711 sigma_y: 0.1 tau: 0.039721431845821824
epoch 37 PSNR: 29.1976318359375 sigma_y: 0.1 tau: 0.039721431845821824
epoch 38 PSNR: 29.206371307373047 sigma_y: 0.1 tau: 0.039721431845821824
epoch 39 PSNR: 29.257919311523438 sigma_y: 0.1 tau: 0.039721431845821824
epoch 40 PSNR: 29.27614974975586 sigma_y: 0.1 tau: 0.035848592240854196
epoch 41 PSNR: 29.305824279785156 sigma_y: 0.1 tau: 0.035848592240854196
epoch 42 PSNR: 29.30915069580078 sigma_y: 0.1 tau: 0.035848592240854196
epoch 43 PSNR: 29.320478439331055 sigma_y: 0.1 tau: 0.035848592240854196
epoch 44 PSNR: 29.35337257385254 sigma_y: 0.1 tau: 0.035848592240854196
epoch 45 PSNR: 29.356185913085938 sigma_y: 0.1 tau: 0.035848592240854196
epoch 46 PSNR: 29.35638427734375 sigma_y: 0.1 tau: 0.035848592240854196
epoch 47 PSNR: 29.39418601989746 sigma_y: 0.1 tau: 0.035848592240854196
epoch 48 PSNR: 29.413488388061523 sigma_y: 0.1 tau: 0.035848592240854196
epoch 49 PSNR: 29.47498321533203 sigma_y: 0.1 tau: 0.035848592240854196
epoch 50 PSNR: 29.37374496459961 sigma_y: 0.1 tau: 0.035848592240854196
epoch 51 PSNR: 29.49120330810547 sigma_y: 0.1 tau: 0.035848592240854196
epoch 52 PSNR: 29.429981231689453 sigma_y: 0.1 tau: 0.035848592240854196
epoch 53 PSNR: 29.470531463623047 sigma_y: 0.1 tau: 0.035848592240854196
epoch 54 PSNR: 29.495466232299805 sigma_y: 0.1 tau: 0.035848592240854196
epoch 55 PSNR: 29.55655288696289 sigma_y: 0.1 tau: 0.035848592240854196
epoch 56 PSNR: 29.546716690063477 sigma_y: 0.1 tau: 0.035848592240854196
epoch 57 PSNR: 29.565128326416016 sigma_y: 0.1 tau: 0.035848592240854196
epoch 58 PSNR: 29.572484970092773 sigma_y: 0.1 tau: 0.030735686772502362
epoch 59 PSNR: 29.590805053710938 sigma_y: 0.1 tau: 0.030735686772502362
epoch 60 PSNR: 29.623205184936523 sigma_y: 0.1 tau: 0.030735686772502362
epoch 61 PSNR: 29.614013671875 sigma_y: 0.1 tau: 0.030735686772502362
epoch 62 PSNR: 29.673778533935547 sigma_y: 0.1 tau: 0.030735686772502362
epoch 63 PSNR: 29.6863956451416 sigma_y: 0.1 tau: 0.030735686772502362
epoch 64 PSNR: 29.67926788330078 sigma_y: 0.1 tau: 0.030735686772502362
epoch 65 PSNR: 29.685056686401367 sigma_y: 0.1 tau: 0.030735686772502362
epoch 66 PSNR: 29.660850524902344 sigma_y: 0.1 tau: 0.030735686772502362
epoch 67 PSNR: 29.65676498413086 sigma_y: 0.1 tau: 0.030735686772502362
epoch 68 PSNR: 29.680034637451172 sigma_y: 0.1 tau: 0.030735686772502362
epoch 69 PSNR: 29.676895141601562 sigma_y: 0.1 tau: 0.030735686772502362
epoch 70 PSNR: 29.712310791015625 sigma_y: 0.1 tau: 0.030735686772502362
epoch 71 PSNR: 29.698259353637695 sigma_y: 0.1 tau: 0.030735686772502362
epoch 72 PSNR: 29.730159759521484 sigma_y: 0.1 tau: 0.030735686772502362
epoch 73 PSNR: 29.68985366821289 sigma_y: 0.1 tau: 0.030735686772502362
epoch 74 PSNR: 29.720291137695312 sigma_y: 0.1 tau: 0.030735686772502362
epoch 75 PSNR: 29.725419998168945 sigma_y: 0.1 tau: 0.030735686772502362
epoch 76 PSNR: 29.72294807434082 sigma_y: 0.1 tau: 0.030735686772502362
epoch 77 PSNR: 29.769851684570312 sigma_y: 0.1 tau: 0.030735686772502362
epoch 78 PSNR: 29.753904342651367 sigma_y: 0.1 tau: 0.030735686772502362
epoch 79 PSNR: 29.77322006225586 sigma_y: 0.1 tau: 0.030735686772502362
epoch 80 PSNR: 29.819435119628906 sigma_y: 0.1 tau: 0.030735686772502362
epoch 81 PSNR: 29.809978485107422 sigma_y: 0.1 tau: 0.030735686772502362
epoch 82 PSNR: 29.837705612182617 sigma_y: 0.1 tau: 0.030735686772502362
epoch 83 PSNR: 29.832212448120117 sigma_y: 0.1 tau: 0.030735686772502362
epoch 84 PSNR: 29.786836624145508 sigma_y: 0.1 tau: 0.030735686772502362
epoch 85 PSNR: 29.801895141601562 sigma_y: 0.1 tau: 0.030735686772502362
main_sampling.py:521: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  LPIPS = loss_fn_vgg(2*orig-1.0, 2*torch.tensor(x[j]).to(torch.float32).cuda()-1.0)[0,0,0,0]
PSNR:29.6044 (0.1615), SSIM:0.78935 (0.00422), LPIPS:0.22871 (0.00172):   0%|          | 0/100 [10:00<?, ?it/s]PSNR:29.6044 (0.1615), SSIM:0.78935 (0.00422), LPIPS:0.22871 (0.00172):   1%|          | 1/100 [10:00<16:30:13, 600.14s/it]epoch 1 PSNR: 15.996779441833496 sigma_y: 1.0 tau: 0.95
epoch 2 PSNR: 17.714679718017578 sigma_y: 1.0 tau: 0.95
epoch 3 PSNR: 19.427928924560547 sigma_y: 1.0 tau: 0.95
epoch 4 PSNR: 21.574373245239258 sigma_y: 1.0 tau: 0.95
epoch 5 PSNR: 22.676334381103516 sigma_y: 1.0 tau: 0.7737809374999999
epoch 6 PSNR: 23.406124114990234 sigma_y: 1.0 tau: 0.7737809374999999
epoch 7 PSNR: 24.194772720336914 sigma_y: 1.0 tau: 0.7737809374999999
epoch 8 PSNR: 24.47271728515625 sigma_y: 1.0 tau: 0.7737809374999999
epoch 9 PSNR: 24.650203704833984 sigma_y: 1.0 tau: 0.7737809374999999
epoch 10 PSNR: 24.795286178588867 sigma_y: 1.0 tau: 0.7737809374999999
epoch 11 PSNR: 24.59127426147461 sigma_y: 1.0 tau: 0.7737809374999999
epoch 12 PSNR: 24.70442008972168 sigma_y: 1.0 tau: 0.7737809374999999
epoch 13 PSNR: 25.00624656677246 sigma_y: 1.0 tau: 0.7737809374999999
epoch 14 PSNR: 24.814393997192383 sigma_y: 1.0 tau: 0.7737809374999999
epoch 15 PSNR: 24.855865478515625 sigma_y: 1.0 tau: 0.7737809374999999
epoch 16 PSNR: 24.540531158447266 sigma_y: 1.0 tau: 0.7737809374999999
epoch 17 PSNR: 24.937917709350586 sigma_y: 0.9129666666666666 tau: 0.7737809374999999
epoch 18 PSNR: 25.036911010742188 sigma_y: 0.8317333333333334 tau: 0.7737809374999999
epoch 19 PSNR: 25.32024574279785 sigma_y: 0.7561000000000001 tau: 0.7737809374999999
epoch 20 PSNR: 25.4637508392334 sigma_y: 0.6858666666666667 tau: 0.7737809374999999
epoch 21 PSNR: 25.713415145874023 sigma_y: 0.6208333333333335 tau: 0.7737809374999999
epoch 22 PSNR: 25.812767028808594 sigma_y: 0.5608000000000001 tau: 0.7737809374999999
epoch 23 PSNR: 25.67243766784668 sigma_y: 0.5055666666666666 tau: 0.7737809374999999
epoch 24 PSNR: 26.13030433654785 sigma_y: 0.4549333333333334 tau: 0.7737809374999999
epoch 25 PSNR: 26.088960647583008 sigma_y: 0.40869999999999995 tau: 0.6634204312890623
epoch 26 PSNR: 26.55355453491211 sigma_y: 0.3666666666666668 tau: 0.5688000922764596
epoch 27 PSNR: 26.483501434326172 sigma_y: 0.32863333333333333 tau: 0.5688000922764596
epoch 28 PSNR: 26.536945343017578 sigma_y: 0.2944 tau: 0.48767497911552943
epoch 29 PSNR: 26.725252151489258 sigma_y: 0.26376666666666665 tau: 0.41812033521917696
epoch 30 PSNR: 26.84463119506836 sigma_y: 0.23653333333333335 tau: 0.37735360253530714
epoch 31 PSNR: 27.114381790161133 sigma_y: 0.1 tau: 0.0857375
epoch 32 PSNR: 27.30677032470703 sigma_y: 0.1 tau: 0.0857375
epoch 33 PSNR: 27.460472106933594 sigma_y: 0.1 tau: 0.0857375
epoch 34 PSNR: 27.510597229003906 sigma_y: 0.1 tau: 0.0857375
epoch 35 PSNR: 27.65102767944336 sigma_y: 0.1 tau: 0.0857375
epoch 36 PSNR: 27.591583251953125 sigma_y: 0.1 tau: 0.0857375
epoch 37 PSNR: 27.68728256225586 sigma_y: 0.1 tau: 0.0857375
epoch 38 PSNR: 27.675636291503906 sigma_y: 0.1 tau: 0.0857375
epoch 39 PSNR: 27.80754280090332 sigma_y: 0.1 tau: 0.08145062499999998
epoch 40 PSNR: 27.821247100830078 sigma_y: 0.1 tau: 0.08145062499999998
epoch 41 PSNR: 27.924663543701172 sigma_y: 0.1 tau: 0.08145062499999998
epoch 42 PSNR: 27.923480987548828 sigma_y: 0.1 tau: 0.08145062499999998
epoch 43 PSNR: 27.981773376464844 sigma_y: 0.1 tau: 0.07350918906249998
epoch 44 PSNR: 27.95333480834961 sigma_y: 0.1 tau: 0.07350918906249998
epoch 45 PSNR: 28.051555633544922 sigma_y: 0.1 tau: 0.07350918906249998
epoch 46 PSNR: 28.034982681274414 sigma_y: 0.1 tau: 0.07350918906249998
epoch 47 PSNR: 28.086227416992188 sigma_y: 0.1 tau: 0.07350918906249998
epoch 48 PSNR: 28.127178192138672 sigma_y: 0.1 tau: 0.07350918906249998
epoch 49 PSNR: 28.11678695678711 sigma_y: 0.1 tau: 0.07350918906249998
epoch 50 PSNR: 28.146345138549805 sigma_y: 0.1 tau: 0.07350918906249998
epoch 51 PSNR: 28.19889259338379 sigma_y: 0.1 tau: 0.06634204312890622
epoch 52 PSNR: 28.16622543334961 sigma_y: 0.1 tau: 0.06634204312890622
epoch 53 PSNR: 28.1827449798584 sigma_y: 0.1 tau: 0.05987369392383786
epoch 54 PSNR: 28.24631690979004 sigma_y: 0.1 tau: 0.05987369392383786
epoch 55 PSNR: 28.256118774414062 sigma_y: 0.1 tau: 0.05403600876626367
epoch 56 PSNR: 28.307331085205078 sigma_y: 0.1 tau: 0.05403600876626367
epoch 57 PSNR: 28.317607879638672 sigma_y: 0.1 tau: 0.05403600876626367
epoch 58 PSNR: 28.332149505615234 sigma_y: 0.1 tau: 0.05403600876626367
epoch 59 PSNR: 28.318180084228516 sigma_y: 0.1 tau: 0.04876749791155295
epoch 60 PSNR: 28.342580795288086 sigma_y: 0.1 tau: 0.04876749791155295
epoch 61 PSNR: 28.362258911132812 sigma_y: 0.1 tau: 0.04876749791155295
epoch 62 PSNR: 28.374797821044922 sigma_y: 0.1 tau: 0.04876749791155295
epoch 63 PSNR: 28.32761573791504 sigma_y: 0.1 tau: 0.04876749791155295
epoch 64 PSNR: 28.335006713867188 sigma_y: 0.1 tau: 0.04876749791155295
epoch 65 PSNR: 28.308483123779297 sigma_y: 0.1 tau: 0.04876749791155295
epoch 66 PSNR: 28.329212188720703 sigma_y: 0.1 tau: 0.04876749791155295
epoch 67 PSNR: 28.335559844970703 sigma_y: 0.1 tau: 0.04876749791155295
epoch 68 PSNR: 28.313095092773438 sigma_y: 0.1 tau: 0.04876749791155295
epoch 69 PSNR: 28.294885635375977 sigma_y: 0.1 tau: 0.04876749791155295
epoch 70 PSNR: 28.29674530029297 sigma_y: 0.1 tau: 0.04876749791155295
epoch 71 PSNR: 28.372594833374023 sigma_y: 0.1 tau: 0.04876749791155295
epoch 72 PSNR: 28.387022018432617 sigma_y: 0.1 tau: 0.04876749791155295
epoch 73 PSNR: 28.37613868713379 sigma_y: 0.1 tau: 0.04876749791155295
epoch 74 PSNR: 28.367979049682617 sigma_y: 0.1 tau: 0.04876749791155295
epoch 75 PSNR: 28.391254425048828 sigma_y: 0.1 tau: 0.04876749791155295
epoch 76 PSNR: 28.39674949645996 sigma_y: 0.1 tau: 0.04876749791155295
epoch 77 PSNR: 28.426551818847656 sigma_y: 0.1 tau: 0.04876749791155295
epoch 78 PSNR: 28.425004959106445 sigma_y: 0.1 tau: 0.04876749791155295
epoch 79 PSNR: 28.46797752380371 sigma_y: 0.1 tau: 0.04876749791155295
epoch 80 PSNR: 28.5202693939209 sigma_y: 0.1 tau: 0.04876749791155295
epoch 81 PSNR: 28.520841598510742 sigma_y: 0.1 tau: 0.04876749791155295
epoch 82 PSNR: 28.550146102905273 sigma_y: 0.1 tau: 0.04876749791155295
epoch 83 PSNR: 28.57272720336914 sigma_y: 0.1 tau: 0.04876749791155295
epoch 84 PSNR: 28.552074432373047 sigma_y: 0.1 tau: 0.04876749791155295
epoch 85 PSNR: 28.567285537719727 sigma_y: 0.1 tau: 0.04876749791155295
PSNR:28.9487 (0.1667), SSIM:0.82209 (0.00366), LPIPS:0.19936 (0.00303):   1%|          | 1/100 [18:22<16:30:13, 600.14s/it]PSNR:28.9487 (0.1667), SSIM:0.82209 (0.00366), LPIPS:0.19936 (0.00303):   2%|▏         | 2/100 [18:22<14:45:49, 542.34s/it]epoch 1 PSNR: 13.615959167480469 sigma_y: 1.0 tau: 0.95
epoch 2 PSNR: 14.863958358764648 sigma_y: 1.0 tau: 0.7350918906249998
epoch 3 PSNR: 16.0849552154541 sigma_y: 1.0 tau: 0.6983372960937497
epoch 4 PSNR: 17.111345291137695 sigma_y: 1.0 tau: 0.6983372960937497
epoch 5 PSNR: 18.663253784179688 sigma_y: 1.0 tau: 0.6983372960937497
epoch 6 PSNR: 21.074514389038086 sigma_y: 1.0 tau: 0.6983372960937497
epoch 7 PSNR: 23.421340942382812 sigma_y: 1.0 tau: 0.6983372960937497
epoch 8 PSNR: 24.319522857666016 sigma_y: 1.0 tau: 0.6983372960937497
epoch 9 PSNR: 24.736732482910156 sigma_y: 1.0 tau: 0.6983372960937497
epoch 10 PSNR: 24.842315673828125 sigma_y: 1.0 tau: 0.6983372960937497
epoch 11 PSNR: 25.09946632385254 sigma_y: 1.0 tau: 0.6983372960937497
epoch 12 PSNR: 25.544391632080078 sigma_y: 1.0 tau: 0.6634204312890623
epoch 13 PSNR: 25.211090087890625 sigma_y: 1.0 tau: 0.6634204312890623
epoch 14 PSNR: 25.220195770263672 sigma_y: 1.0 tau: 0.6634204312890623
epoch 15 PSNR: 25.057483673095703 sigma_y: 1.0 tau: 0.6634204312890623
epoch 16 PSNR: 25.30165672302246 sigma_y: 1.0 tau: 0.6634204312890623
epoch 17 PSNR: 25.396404266357422 sigma_y: 0.9129666666666666 tau: 0.6634204312890623
epoch 18 PSNR: 25.193281173706055 sigma_y: 0.8317333333333334 tau: 0.6634204312890623
epoch 19 PSNR: 25.76063346862793 sigma_y: 0.7561000000000001 tau: 0.6634204312890623
epoch 20 PSNR: 25.98964500427246 sigma_y: 0.6858666666666667 tau: 0.6634204312890623
epoch 21 PSNR: 25.930496215820312 sigma_y: 0.6208333333333335 tau: 0.6634204312890623
epoch 22 PSNR: 26.22348403930664 sigma_y: 0.5608000000000001 tau: 0.6634204312890623
epoch 23 PSNR: 26.554309844970703 sigma_y: 0.5055666666666666 tau: 0.6302494097246091
epoch 24 PSNR: 26.680261611938477 sigma_y: 0.4549333333333334 tau: 0.6302494097246091
PSNR:28.9487 (0.1667), SSIM:0.82209 (0.00366), LPIPS:0.19936 (0.00303):   2%|▏         | 2/100 [20:43<16:55:49, 621.93s/it]
Traceback (most recent call last):
  File "main_sampling.py", line 1040, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 838, in hmc
    loss_grad = torch.autograd.grad(loss, x_proposal, retain_graph=False)[0]
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/__init__.py", line 436, in grad
    result = _engine_run_backward(
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 801540) is killed by signal: Terminated. 
