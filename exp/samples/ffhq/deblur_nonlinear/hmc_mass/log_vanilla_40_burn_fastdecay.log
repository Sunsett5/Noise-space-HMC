nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
epoch 1 PSNR: 16.503482818603516 sigma_y: 1.0 tau: 1.0
epoch 2 PSNR: 18.366296768188477 sigma_y: 1.0 tau: 1.0
epoch 3 PSNR: 20.957067489624023 sigma_y: 1.0 tau: 1.0
epoch 4 PSNR: 22.068843841552734 sigma_y: 1.0 tau: 1.0
epoch 5 PSNR: 24.407331466674805 sigma_y: 1.0 tau: 1.0
epoch 6 PSNR: 25.54979705810547 sigma_y: 1.0 tau: 1.0
epoch 7 PSNR: 25.68158721923828 sigma_y: 0.8929861240234374 tau: 1.0
epoch 8 PSNR: 26.587697982788086 sigma_y: 0.7964028437499998 tau: 0.8573749999999999
epoch 9 PSNR: 26.989643096923828 sigma_y: 0.7094683720703125 tau: 0.8145062499999999
epoch 10 PSNR: 26.605836868286133 sigma_y: 0.631441 tau: 0.8145062499999999
epoch 11 PSNR: 27.25950050354004 sigma_y: 0.5616180419921876 tau: 0.6983372960937497
epoch 12 PSNR: 27.556537628173828 sigma_y: 0.49933478124999997 tau: 0.6634204312890623
epoch 13 PSNR: 27.712080001831055 sigma_y: 0.44396341503906245 tau: 0.5133420832795047
epoch 14 PSNR: 28.147693634033203 sigma_y: 0.39491200000000004 tau: 0.44012666865176525
epoch 15 PSNR: 28.38568687438965 sigma_y: 0.3516233974609375 tau: 0.34056162628811465
epoch 16 PSNR: 28.28040313720703 sigma_y: 0.31357421875 tau: 0.3235335449737089
epoch 17 PSNR: 28.5072021484375 sigma_y: 0.2802737705078125 tau: 0.2919890243387723
epoch 18 PSNR: 28.670669555664062 sigma_y: 0.25126299999999996 tau: 0.2919890243387723
epoch 19 PSNR: 28.66142463684082 sigma_y: 0.22611344042968756 tau: 0.1937114844585008
epoch 20 PSNR: 28.781564712524414 sigma_y: 0.20442615625000002 tau: 0.1937114844585008
epoch 21 PSNR: 28.94193458557129 sigma_y: 0.1858306884765625 tau: 0.1937114844585008
epoch 22 PSNR: 29.02396011352539 sigma_y: 0.169984 tau: 0.15777921478822676
epoch 23 PSNR: 29.05936050415039 sigma_y: 0.1565694208984375 tau: 0.15777921478822676
epoch 24 PSNR: 29.169063568115234 sigma_y: 0.14529559375 tau: 0.14989025404881542
epoch 25 PSNR: 29.231555938720703 sigma_y: 0.1358954189453125 tau: 0.1352759542790559
epoch 26 PSNR: 29.294862747192383 sigma_y: 0.12812500000000002 tau: 0.0852575903343082
epoch 27 PSNR: 29.276657104492188 sigma_y: 0.1217625888671875 tau: 0.0852575903343082
epoch 28 PSNR: 29.342628479003906 sigma_y: 0.11660753125000001 tau: 0.0852575903343082
epoch 29 PSNR: 29.36660385131836 sigma_y: 0.11247921191406252 tau: 0.08099471081759278
epoch 30 PSNR: 29.40843391418457 sigma_y: 0.10921600000000001 tau: 0.0659706981778719
epoch 31 PSNR: 29.452022552490234 sigma_y: 0.1066741943359375 tau: 0.0659706981778719
epoch 32 PSNR: 29.478878021240234 sigma_y: 0.10472696875000001 tau: 0.0659706981778719
epoch 33 PSNR: 29.496858596801758 sigma_y: 0.1032633173828125 tau: 0.0659706981778719
epoch 34 PSNR: 29.505725860595703 sigma_y: 0.102187 tau: 0.0659706981778719
epoch 35 PSNR: 29.570589065551758 sigma_y: 0.10141548730468751 tau: 0.0659706981778719
epoch 36 PSNR: 29.567787170410156 sigma_y: 0.10087890625000001 tau: 0.0659706981778719
epoch 37 PSNR: 29.57378578186035 sigma_y: 0.1005189853515625 tau: 0.0659706981778719
epoch 38 PSNR: 29.542818069458008 sigma_y: 0.100288 tau: 0.0659706981778719
epoch 39 PSNR: 29.603839874267578 sigma_y: 0.1001477177734375 tau: 0.0659706981778719
epoch 40 PSNR: 29.658557891845703 sigma_y: 0.10006834375000001 tau: 0.0659706981778719
epoch 41 PSNR: 29.665142059326172 sigma_y: 0.1 tau: 0.059538555105529384
epoch 42 PSNR: 29.682071685791016 sigma_y: 0.1 tau: 0.05656162735025291
epoch 43 PSNR: 29.75031280517578 sigma_y: 0.1 tau: 0.05656162735025291
epoch 44 PSNR: 29.727577209472656 sigma_y: 0.1 tau: 0.05656162735025291
epoch 45 PSNR: 29.78609848022461 sigma_y: 0.1 tau: 0.05656162735025291
epoch 46 PSNR: 29.78900718688965 sigma_y: 0.1 tau: 0.05656162735025291
epoch 47 PSNR: 29.801597595214844 sigma_y: 0.1 tau: 0.05656162735025291
epoch 48 PSNR: 29.82856559753418 sigma_y: 0.1 tau: 0.05656162735025291
epoch 49 PSNR: 29.848711013793945 sigma_y: 0.1 tau: 0.05656162735025291
epoch 50 PSNR: 29.853748321533203 sigma_y: 0.1 tau: 0.05656162735025291
epoch 51 PSNR: 29.87677574157715 sigma_y: 0.1 tau: 0.05656162735025291
epoch 52 PSNR: 29.87179183959961 sigma_y: 0.1 tau: 0.053733545982740265
epoch 53 PSNR: 29.878604888916016 sigma_y: 0.1 tau: 0.053733545982740265
epoch 54 PSNR: 29.90668487548828 sigma_y: 0.1 tau: 0.053733545982740265
epoch 55 PSNR: 29.886058807373047 sigma_y: 0.1 tau: 0.053733545982740265
epoch 56 PSNR: 29.889707565307617 sigma_y: 0.1 tau: 0.053733545982740265
epoch 57 PSNR: 29.90808868408203 sigma_y: 0.1 tau: 0.053733545982740265
epoch 58 PSNR: 29.933757781982422 sigma_y: 0.1 tau: 0.053733545982740265
epoch 59 PSNR: 29.959014892578125 sigma_y: 0.1 tau: 0.053733545982740265
epoch 60 PSNR: 29.94249153137207 sigma_y: 0.1 tau: 0.053733545982740265
epoch 61 PSNR: 29.96917724609375 sigma_y: 0.1 tau: 0.053733545982740265
epoch 62 PSNR: 29.954029083251953 sigma_y: 0.1 tau: 0.053733545982740265
epoch 63 PSNR: 29.966276168823242 sigma_y: 0.1 tau: 0.053733545982740265
epoch 64 PSNR: 29.935707092285156 sigma_y: 0.1 tau: 0.053733545982740265
epoch 65 PSNR: 29.993858337402344 sigma_y: 0.1 tau: 0.053733545982740265
epoch 66 PSNR: 29.962873458862305 sigma_y: 0.1 tau: 0.053733545982740265
epoch 67 PSNR: 29.992671966552734 sigma_y: 0.1 tau: 0.053733545982740265
epoch 68 PSNR: 29.985973358154297 sigma_y: 0.1 tau: 0.053733545982740265
epoch 69 PSNR: 30.017454147338867 sigma_y: 0.1 tau: 0.053733545982740265
epoch 70 PSNR: 29.980127334594727 sigma_y: 0.1 tau: 0.053733545982740265
epoch 71 PSNR: 30.04916000366211 sigma_y: 0.1 tau: 0.053733545982740265
epoch 72 PSNR: 30.021888732910156 sigma_y: 0.1 tau: 0.05104686868360325
epoch 73 PSNR: 30.028507232666016 sigma_y: 0.1 tau: 0.05104686868360325
epoch 74 PSNR: 30.025611877441406 sigma_y: 0.1 tau: 0.05104686868360325
epoch 75 PSNR: 30.024425506591797 sigma_y: 0.1 tau: 0.05104686868360325
epoch 76 PSNR: 30.03919792175293 sigma_y: 0.1 tau: 0.05104686868360325
epoch 77 PSNR: 30.03057289123535 sigma_y: 0.1 tau: 0.05104686868360325
epoch 78 PSNR: 30.04717254638672 sigma_y: 0.1 tau: 0.05104686868360325
epoch 79 PSNR: 29.997289657592773 sigma_y: 0.1 tau: 0.05104686868360325
epoch 80 PSNR: 29.980178833007812 sigma_y: 0.1 tau: 0.05104686868360325
epoch 81 PSNR: 29.976360321044922 sigma_y: 0.1 tau: 0.05104686868360325
epoch 82 PSNR: 29.987756729125977 sigma_y: 0.1 tau: 0.05104686868360325
epoch 83 PSNR: 29.985736846923828 sigma_y: 0.1 tau: 0.04376630903760433
epoch 84 PSNR: 29.99431610107422 sigma_y: 0.1 tau: 0.041577993585724116
epoch 85 PSNR: 29.984596252441406 sigma_y: 0.1 tau: 0.041577993585724116
main_sampling.py:521: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  LPIPS = loss_fn_vgg(2*orig-1.0, 2*torch.tensor(x[j]).to(torch.float32).cuda()-1.0)[0,0,0,0]
PSNR:29.9710 (0.0516), SSIM:0.79834 (0.00102), LPIPS:0.23485 (0.00172):   0%|          | 0/100 [10:34<?, ?it/s]PSNR:29.9710 (0.0516), SSIM:0.79834 (0.00102), LPIPS:0.23485 (0.00172):   1%|          | 1/100 [10:34<17:27:01, 634.56s/it]epoch 1 PSNR: 17.17987823486328 sigma_y: 1.0 tau: 0.7737809374999999
epoch 2 PSNR: 17.75678253173828 sigma_y: 1.0 tau: 0.7737809374999999
epoch 3 PSNR: 19.21549415588379 sigma_y: 1.0 tau: 0.7737809374999999
epoch 4 PSNR: 20.097810745239258 sigma_y: 1.0 tau: 0.7737809374999999
epoch 5 PSNR: 21.321027755737305 sigma_y: 1.0 tau: 0.7737809374999999
epoch 6 PSNR: 22.664051055908203 sigma_y: 1.0 tau: 0.7350918906249998
epoch 7 PSNR: 23.53598403930664 sigma_y: 0.8929861240234374 tau: 0.7350918906249998
epoch 8 PSNR: 24.359071731567383 sigma_y: 0.7964028437499998 tau: 0.7350918906249998
epoch 9 PSNR: 24.67156219482422 sigma_y: 0.7094683720703125 tau: 0.6983372960937497
epoch 10 PSNR: 25.43433380126953 sigma_y: 0.631441 tau: 0.6983372960937497
epoch 11 PSNR: 25.62567710876465 sigma_y: 0.5616180419921876 tau: 0.6983372960937497
epoch 12 PSNR: 25.7882137298584 sigma_y: 0.49933478124999997 tau: 0.6983372960937497
epoch 13 PSNR: 25.803510665893555 sigma_y: 0.44396341503906245 tau: 0.6983372960937497
epoch 14 PSNR: 26.15044593811035 sigma_y: 0.39491200000000004 tau: 0.6302494097246091
epoch 15 PSNR: 26.109458923339844 sigma_y: 0.3516233974609375 tau: 0.5688000922764596
epoch 16 PSNR: 26.5709285736084 sigma_y: 0.31357421875 tau: 0.5403600876626365
epoch 17 PSNR: 26.712636947631836 sigma_y: 0.2802737705078125 tau: 0.48767497911552943
epoch 18 PSNR: 26.79365348815918 sigma_y: 0.25126299999999996 tau: 0.3972143184582181
epoch 19 PSNR: 27.2235107421875 sigma_y: 0.22611344042968756 tau: 0.37735360253530714
epoch 20 PSNR: 27.221912384033203 sigma_y: 0.20442615625000002 tau: 0.30735686772502346
epoch 21 PSNR: 27.355117797851562 sigma_y: 0.1858306884765625 tau: 0.30735686772502346
epoch 22 PSNR: 27.412111282348633 sigma_y: 0.169984 tau: 0.27738957312183365
epoch 23 PSNR: 27.55487823486328 sigma_y: 0.1565694208984375 tau: 0.2378268852553321
epoch 24 PSNR: 27.579469680786133 sigma_y: 0.14529559375 tau: 0.2378268852553321
epoch 25 PSNR: 27.734180450439453 sigma_y: 0.1358954189453125 tau: 0.2378268852553321
epoch 26 PSNR: 27.76830291748047 sigma_y: 0.12812500000000002 tau: 0.2146387639429372
epoch 27 PSNR: 27.849895477294922 sigma_y: 0.1217625888671875 tau: 0.2146387639429372
epoch 28 PSNR: 27.92099380493164 sigma_y: 0.11660753125000001 tau: 0.20390682574579033
epoch 29 PSNR: 28.047657012939453 sigma_y: 0.11247921191406252 tau: 0.18402591023557577
epoch 30 PSNR: 28.083702087402344 sigma_y: 0.10921600000000001 tau: 0.18402591023557577
epoch 31 PSNR: 28.142593383789062 sigma_y: 0.1066741943359375 tau: 0.12208654873684793
epoch 32 PSNR: 28.128131866455078 sigma_y: 0.10472696875000001 tau: 0.11018311023500525
epoch 33 PSNR: 28.14731788635254 sigma_y: 0.1032633173828125 tau: 0.11018311023500525
epoch 34 PSNR: 28.202678680419922 sigma_y: 0.102187 tau: 0.11018311023500525
epoch 35 PSNR: 28.21790885925293 sigma_y: 0.10141548730468751 tau: 0.11018311023500525
epoch 36 PSNR: 28.28758430480957 sigma_y: 0.10087890625000001 tau: 0.11018311023500525
epoch 37 PSNR: 28.286083221435547 sigma_y: 0.1005189853515625 tau: 0.11018311023500525
epoch 38 PSNR: 28.316804885864258 sigma_y: 0.100288 tau: 0.11018311023500525
epoch 39 PSNR: 28.33462905883789 sigma_y: 0.1001477177734375 tau: 0.11018311023500525
epoch 40 PSNR: 28.345298767089844 sigma_y: 0.10006834375000001 tau: 0.11018311023500525
epoch 41 PSNR: 28.363468170166016 sigma_y: 0.1 tau: 0.06983372960937498
epoch 42 PSNR: 28.36823272705078 sigma_y: 0.1 tau: 0.06983372960937498
epoch 43 PSNR: 28.370529174804688 sigma_y: 0.1 tau: 0.06983372960937498
epoch 44 PSNR: 28.404067993164062 sigma_y: 0.1 tau: 0.06983372960937498
epoch 45 PSNR: 28.3978271484375 sigma_y: 0.1 tau: 0.06983372960937498
epoch 46 PSNR: 28.333797454833984 sigma_y: 0.1 tau: 0.06983372960937498
epoch 47 PSNR: 28.374881744384766 sigma_y: 0.1 tau: 0.06983372960937498
epoch 48 PSNR: 28.41840362548828 sigma_y: 0.1 tau: 0.06983372960937498
epoch 49 PSNR: 28.38089370727539 sigma_y: 0.1 tau: 0.06983372960937498
PSNR:29.9710 (0.0516), SSIM:0.79834 (0.00102), LPIPS:0.23485 (0.00172):   1%|          | 1/100 [17:29<28:52:08, 1049.78s/it]
Traceback (most recent call last):
  File "main_sampling.py", line 1040, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 836, in hmc
    xt = iterative_sampling(x_proposal, n, b, seq, seq_next, algo, opt, y_0, tqdm_disable=True).clip(-1, 1)
  File "main_sampling.py", line 902, in iterative_sampling
    t = (torch.ones(n) * i).to(xt.device)
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 825552) is killed by signal: Terminated. 
