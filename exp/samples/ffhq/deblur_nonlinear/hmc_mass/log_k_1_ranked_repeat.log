nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
M_diag tensor([0.5714, 1.5375, 0.5778, 1.0118, 0.7706, 0.4342, 0.6004, 1.5803, 0.6213,
        0.5298], device='cuda:0')
epoch 1 PSNR: 15.669774055480957 sigma_y: 1.7000000000000002 tau: 1.0
M_diag tensor([1.0677, 0.5950, 0.7859, 0.6949, 1.3118, 2.4542, 1.5137, 1.1397, 1.1434,
        0.6417], device='cuda:0')
epoch 2 PSNR: 19.426538467407227 sigma_y: 1.6471111111111112 tau: 0.95
M_diag tensor([0.5243, 1.0527, 2.4361, 1.4517, 0.4056, 0.9591, 0.9749, 0.4102, 0.6765,
        0.8049], device='cuda:0')
epoch 3 PSNR: 20.884376525878906 sigma_y: 1.5951111111111111 tau: 0.95
M_diag tensor([1.9879, 0.7484, 0.8696, 0.8141, 0.5515, 2.5767, 0.7156, 1.4736, 0.7247,
        1.3652], device='cuda:0')
epoch 4 PSNR: 21.783672332763672 sigma_y: 1.544 tau: 0.95
M_diag tensor([1.0197, 2.3687, 1.0980, 2.1809, 1.4350, 0.5358, 0.5521, 1.3960, 0.7697,
        2.5302], device='cuda:0')
epoch 5 PSNR: 22.44729232788086 sigma_y: 1.493777777777778 tau: 0.95
M_diag tensor([1.8830, 0.9779, 1.2714, 0.4988, 0.9066, 1.9233, 0.5588, 0.9000, 0.3998,
        0.4382], device='cuda:0')
epoch 6 PSNR: 21.518754959106445 sigma_y: 1.4444444444444444 tau: 0.95
M_diag tensor([1.8693, 1.1271, 2.4283, 2.6220, 0.5441, 0.7227, 1.6556, 0.9886, 0.5213,
        2.3844], device='cuda:0')
epoch 7 PSNR: 21.082386016845703 sigma_y: 1.3960000000000004 tau: 0.9025
M_diag tensor([0.4031, 0.8438, 0.8422, 0.9881, 0.7540, 1.8394, 0.4226, 1.0974, 1.9463,
        0.4369], device='cuda:0')
epoch 8 PSNR: 20.938274383544922 sigma_y: 1.3484444444444446 tau: 0.9025
M_diag tensor([1.7229, 1.7724, 1.1278, 1.0121, 0.6807, 0.5465, 1.1913, 0.7564, 0.4816,
        0.6759], device='cuda:0')
epoch 9 PSNR: 23.517122268676758 sigma_y: 1.3017777777777781 tau: 0.7737809374999999
M_diag tensor([0.6452, 0.3903, 0.8189, 0.5115, 2.2891, 2.1971, 1.7534, 0.9719, 1.3320,
        0.6236], device='cuda:0')
epoch 10 PSNR: 23.953752517700195 sigma_y: 1.256 tau: 0.7737809374999999
M_diag tensor([0.7752, 0.5966, 0.4794, 1.3143, 0.4386, 1.6324, 0.7276, 2.0137, 1.2737,
        1.8956], device='cuda:0')
epoch 11 PSNR: 23.88381576538086 sigma_y: 1.2111111111111115 tau: 0.7737809374999999
M_diag tensor([0.8036, 2.2463, 1.7481, 2.1776, 2.6179, 1.1386, 1.1250, 0.4784, 1.2140,
        0.6241], device='cuda:0')
epoch 12 PSNR: 24.24755859375 sigma_y: 1.1671111111111112 tau: 0.7737809374999999
M_diag tensor([0.9396, 0.4177, 2.0486, 0.9563, 0.8019, 0.7909, 2.0653, 2.6290, 0.3749,
        0.5599], device='cuda:0')
epoch 13 PSNR: 23.820009231567383 sigma_y: 1.1240000000000003 tau: 0.7737809374999999
M_diag tensor([2.6451, 1.3409, 0.4942, 0.8090, 1.0075, 1.1102, 0.4290, 1.7391, 0.4238,
        2.2888], device='cuda:0')
epoch 14 PSNR: 24.307506561279297 sigma_y: 1.081777777777778 tau: 0.6634204312890623
M_diag tensor([0.5521, 0.6912, 2.6666, 0.7142, 1.7762, 0.5514, 2.6950, 1.2775, 2.5670,
        0.4367], device='cuda:0')
epoch 15 PSNR: 24.6334285736084 sigma_y: 1.0404444444444445 tau: 0.6634204312890623
M_diag tensor([2.2615, 2.1932, 1.2892, 1.8001, 0.6542, 1.9912, 0.3739, 1.9651, 0.5534,
        1.0880], device='cuda:0')
epoch 16 PSNR: 24.737627029418945 sigma_y: 1.0 tau: 0.6634204312890623
M_diag tensor([0.3863, 1.0382, 1.0475, 1.2677, 2.4082, 1.4786, 2.6095, 1.0772, 2.5560,
        0.8157], device='cuda:0')
epoch 17 PSNR: 24.466793060302734 sigma_y: 0.9604444444444447 tau: 0.5987369392383786
M_diag tensor([0.4588, 1.6520, 1.2264, 1.8447, 0.5137, 1.9485, 0.9182, 2.7033, 0.5386,
        1.9686], device='cuda:0')
epoch 18 PSNR: 24.900104522705078 sigma_y: 0.9217777777777778 tau: 0.5987369392383786
M_diag tensor([1.1419, 0.5712, 0.6282, 1.0520, 1.6040, 0.5400, 1.9686, 0.3746, 0.3893,
        0.7595], device='cuda:0')
epoch 19 PSNR: 24.99810028076172 sigma_y: 0.8839999999999999 tau: 0.5688000922764596
M_diag tensor([0.3709, 2.4795, 1.5091, 1.1753, 1.7076, 1.4257, 0.4432, 0.6721, 0.4330,
        1.0335], device='cuda:0')
epoch 20 PSNR: 24.797086715698242 sigma_y: 0.8471111111111111 tau: 0.5688000922764596
M_diag tensor([1.1437, 0.5363, 1.3774, 0.5825, 2.1727, 1.7854, 1.0746, 1.3098, 1.4803,
        0.4427], device='cuda:0')
epoch 21 PSNR: 25.51736831665039 sigma_y: 0.8111111111111112 tau: 0.5688000922764596
M_diag tensor([1.3032, 0.8340, 0.9344, 0.5588, 1.5554, 1.2431, 1.7866, 0.4548, 0.9250,
        1.2361], device='cuda:0')
epoch 22 PSNR: 25.664752960205078 sigma_y: 0.7760000000000001 tau: 0.5133420832795047
M_diag tensor([0.4055, 0.4208, 1.6617, 0.8507, 0.7610, 0.4919, 0.3702, 1.2212, 0.8873,
        2.1266], device='cuda:0')
epoch 23 PSNR: 26.262189865112305 sigma_y: 0.7417777777777778 tau: 0.5133420832795047
M_diag tensor([1.4459, 0.9500, 0.7944, 0.5057, 0.7340, 1.6519, 0.8318, 0.8039, 0.8538,
        1.0522], device='cuda:0')
epoch 24 PSNR: 26.27920913696289 sigma_y: 0.7084444444444445 tau: 0.5133420832795047
M_diag tensor([0.8091, 1.9012, 0.7692, 0.8065, 0.8478, 0.5624, 0.6584, 0.5067, 0.6963,
        0.8832], device='cuda:0')
epoch 25 PSNR: 26.91106414794922 sigma_y: 0.6759999999999999 tau: 0.5133420832795047
M_diag tensor([2.2757, 0.7862, 1.5303, 2.1138, 1.9689, 0.8475, 1.4863, 0.9939, 1.1719,
        1.7952], device='cuda:0')
epoch 26 PSNR: 26.710887908935547 sigma_y: 0.6444444444444443 tau: 0.5133420832795047
M_diag tensor([1.1063, 0.6735, 1.1739, 0.7657, 0.6931, 1.1159, 0.6814, 0.8059, 1.8148,
        0.8733], device='cuda:0')
epoch 27 PSNR: 27.001609802246094 sigma_y: 0.6137777777777778 tau: 0.5133420832795047
M_diag tensor([0.6383, 1.7160, 1.1210, 1.0702, 2.6357, 1.0995, 0.8018, 1.4319, 1.7904,
        0.5385], device='cuda:0')
epoch 28 PSNR: 27.35243034362793 sigma_y: 0.5840000000000001 tau: 0.5133420832795047
M_diag tensor([0.4572, 0.6481, 0.8668, 0.4453, 0.7417, 1.4633, 0.4196, 0.3905, 1.3418,
        1.2848], device='cuda:0')
epoch 29 PSNR: 27.237442016601562 sigma_y: 0.5551111111111111 tau: 0.5133420832795047
M_diag tensor([1.2740, 0.6542, 0.6729, 0.8633, 0.7428, 0.3916, 2.1732, 2.3528, 1.9864,
        0.8342], device='cuda:0')
epoch 30 PSNR: 27.53179168701172 sigma_y: 0.527111111111111 tau: 0.5133420832795047
M_diag tensor([0.9583, 1.0346, 0.9521, 1.6735, 0.9885, 2.0300, 0.4633, 0.5147, 1.5958,
        1.9412], device='cuda:0')
epoch 31 PSNR: 27.583768844604492 sigma_y: 0.5 tau: 0.48767497911552943
M_diag tensor([1.6124, 2.2024, 2.3104, 0.6608, 1.7820, 2.1044, 2.4037, 1.5812, 2.0320,
        0.7691], device='cuda:0')
epoch 32 PSNR: 27.392662048339844 sigma_y: 0.47377777777777774 tau: 0.48767497911552943
M_diag tensor([1.3533, 0.3947, 0.3841, 1.4876, 1.2154, 0.6350, 0.3798, 1.1408, 0.8169,
        1.0524], device='cuda:0')
epoch 33 PSNR: 27.562625885009766 sigma_y: 0.44844444444444453 tau: 0.41812033521917696
M_diag tensor([0.3734, 2.3615, 1.5941, 1.0296, 0.8582, 0.6764, 1.7583, 1.0653, 1.1292,
        0.8218], device='cuda:0')
epoch 34 PSNR: 27.745361328125 sigma_y: 0.42399999999999993 tau: 0.41812033521917696
M_diag tensor([1.9827, 1.6222, 1.3929, 0.4471, 1.8238, 1.6268, 1.3054, 0.4263, 0.4604,
        1.5345], device='cuda:0')
epoch 35 PSNR: 27.982900619506836 sigma_y: 0.4004444444444445 tau: 0.3972143184582181
M_diag tensor([1.6165, 1.0058, 0.6217, 1.1560, 0.7874, 0.6685, 1.2001, 2.3738, 2.2849,
        0.5993], device='cuda:0')
epoch 36 PSNR: 27.934284210205078 sigma_y: 0.37777777777777777 tau: 0.3972143184582181
M_diag tensor([0.7472, 0.9530, 2.3249, 1.8363, 1.8843, 2.3027, 1.5348, 0.6627, 0.9793,
        0.4631], device='cuda:0')
epoch 37 PSNR: 28.09583854675293 sigma_y: 0.3560000000000001 tau: 0.3235335449737089
M_diag tensor([0.6006, 2.0572, 1.7408, 0.6284, 0.6167, 0.9055, 1.2858, 0.8327, 1.3692,
        0.7908], device='cuda:0')
epoch 38 PSNR: 28.07333755493164 sigma_y: 0.33511111111111114 tau: 0.3235335449737089
M_diag tensor([0.4621, 0.3730, 0.8536, 2.0554, 1.5340, 2.3464, 1.2073, 1.6100, 1.2068,
        2.2474], device='cuda:0')
epoch 39 PSNR: 28.308284759521484 sigma_y: 0.3151111111111112 tau: 0.263520094465742
M_diag tensor([1.1441, 0.5199, 1.8776, 1.1707, 1.7537, 0.6016, 2.4732, 0.3914, 0.4349,
        0.7641], device='cuda:0')
epoch 40 PSNR: 28.453956604003906 sigma_y: 0.296 tau: 0.263520094465742
M_diag tensor([1.9286, 2.7000, 0.3782, 2.2549, 1.7031, 1.4383, 1.0735, 0.3995, 0.4230,
        0.8711], device='cuda:0')
epoch 41 PSNR: 28.425762176513672 sigma_y: 0.2777777777777778 tau: 0.263520094465742
M_diag tensor([0.9772, 0.5417, 2.2352, 1.3651, 0.8733, 0.7526, 0.3810, 0.7211, 1.1395,
        0.8756], device='cuda:0')
epoch 42 PSNR: 28.3402042388916 sigma_y: 0.2604444444444445 tau: 0.2146387639429372
M_diag tensor([1.5149, 0.5525, 0.4631, 1.8434, 1.3591, 0.7582, 2.6400, 1.1514, 0.8788,
        0.8636], device='cuda:0')
epoch 43 PSNR: 28.57024383544922 sigma_y: 0.24400000000000005 tau: 0.20390682574579033
M_diag tensor([0.6025, 1.8752, 0.8552, 2.0165, 1.0781, 1.4072, 1.1037, 1.0006, 0.4887,
        2.3371], device='cuda:0')
epoch 44 PSNR: 28.5653018951416 sigma_y: 0.22844444444444445 tau: 0.20390682574579033
M_diag tensor([2.3157, 0.3782, 0.7451, 1.2814, 0.4318, 0.6864, 0.8868, 0.7851, 1.1903,
        1.2919], device='cuda:0')
epoch 45 PSNR: 28.613779067993164 sigma_y: 0.21377777777777784 tau: 0.20390682574579033
M_diag tensor([1.8084, 1.3568, 1.6791, 1.4576, 2.4188, 1.4074, 0.3954, 0.9712, 0.5575,
        0.8936], device='cuda:0')
epoch 46 PSNR: 28.63389015197754 sigma_y: 0.2 tau: 0.1937114844585008
M_diag tensor([0.6398, 1.3002, 0.5460, 0.9131, 0.4160, 0.3964, 0.4917, 0.7246, 1.3673,
        1.0500], device='cuda:0')
epoch 47 PSNR: 28.678081512451172 sigma_y: 0.1871111111111111 tau: 0.14239574134637464
M_diag tensor([1.7203, 1.0107, 0.5239, 1.4964, 2.5501, 1.6090, 0.9687, 2.0843, 2.2035,
        0.8609], device='cuda:0')
epoch 48 PSNR: 28.681652069091797 sigma_y: 0.17511111111111113 tau: 0.14239574134637464
M_diag tensor([0.7032, 0.9694, 0.9604, 0.4587, 1.5307, 0.8843, 1.9851, 0.3767, 0.5821,
        0.9534], device='cuda:0')
epoch 49 PSNR: 28.717119216918945 sigma_y: 0.16399999999999998 tau: 0.14239574134637464
M_diag tensor([0.5847, 2.1634, 0.7842, 0.5094, 0.6416, 1.3396, 2.2001, 1.8316, 0.4833,
        0.5099], device='cuda:0')
epoch 50 PSNR: 28.77756118774414 sigma_y: 0.1537777777777778 tau: 0.14239574134637464
M_diag tensor([0.6375, 1.1580, 0.5554, 2.1051, 0.8647, 0.4836, 1.5413, 0.6636, 1.3462,
        0.5860], device='cuda:0')
epoch 51 PSNR: 28.897640228271484 sigma_y: 0.14444444444444443 tau: 0.14239574134637464
M_diag tensor([1.5325, 1.5156, 2.1425, 1.4220, 0.5145, 2.1685, 0.6467, 1.2822, 1.5182,
        0.7653], device='cuda:0')
epoch 52 PSNR: 28.95870018005371 sigma_y: 0.136 tau: 0.14239574134637464
M_diag tensor([1.4710, 1.2501, 1.0107, 1.4289, 0.4277, 1.3501, 2.1748, 1.3099, 0.9471,
        1.2797], device='cuda:0')
epoch 53 PSNR: 29.08275604248047 sigma_y: 0.12844444444444444 tau: 0.1352759542790559
M_diag tensor([0.7559, 0.6865, 1.1676, 0.8537, 1.4197, 0.4738, 0.6512, 0.3993, 2.6786,
        1.2547], device='cuda:0')
epoch 54 PSNR: 29.07303810119629 sigma_y: 0.12177777777777779 tau: 0.1352759542790559
M_diag tensor([1.3115, 2.4645, 1.8192, 0.5727, 0.8656, 1.5625, 0.5902, 2.5816, 0.4467,
        0.4738], device='cuda:0')
epoch 55 PSNR: 29.213939666748047 sigma_y: 0.11599999999999999 tau: 0.11018311023500525
M_diag tensor([1.0067, 0.5334, 0.4913, 0.5980, 0.4654, 1.7545, 2.0932, 0.5758, 0.7480,
        1.3721], device='cuda:0')
epoch 56 PSNR: 29.293560028076172 sigma_y: 0.11111111111111113 tau: 0.11018311023500525
M_diag tensor([0.6831, 2.0060, 2.4310, 0.4303, 2.6836, 1.3525, 0.5566, 0.8645, 1.1515,
        0.7372], device='cuda:0')
epoch 57 PSNR: 29.39331817626953 sigma_y: 0.10711111111111112 tau: 0.10467395472325498
M_diag tensor([2.3606, 0.5166, 0.4618, 1.4436, 1.0752, 0.4145, 1.6148, 0.3786, 1.0261,
        0.9025], device='cuda:0')
epoch 58 PSNR: 29.417583465576172 sigma_y: 0.10400000000000001 tau: 0.10467395472325498
M_diag tensor([0.3741, 2.2733, 0.5933, 1.0332, 0.7811, 2.7131, 2.0253, 2.6728, 0.5022,
        0.4314], device='cuda:0')
epoch 59 PSNR: 29.469907760620117 sigma_y: 0.10177777777777779 tau: 0.10467395472325498
M_diag tensor([1.7556, 0.8986, 0.7412, 1.1782, 2.3038, 0.6583, 0.7839, 0.6426, 0.6693,
        0.4247], device='cuda:0')
epoch 60 PSNR: 29.43370819091797 sigma_y: 0.10044444444444445 tau: 0.10467395472325498
  0%|          | 0/100 [08:15<?, ?it/s]
Traceback (most recent call last):
  File "main_sampling.py", line 1045, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 833, in hmc
    xt = iterative_sampling(x_proposal, n, b, seq, seq_next, algo, opt, y_0, tqdm_disable=True).clip(-1, 1)
  File "main_sampling.py", line 907, in iterative_sampling
    t = (torch.ones(n) * i).to(xt.device)
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 248553) is killed by signal: Terminated. 
