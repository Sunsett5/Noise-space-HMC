nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
M_diag tensor([0.7496, 1.2356, 0.7645, 1.0108, 0.8812, 0.6552, 0.7712, 1.2545, 0.7940,
        0.7320], device='cuda:0')
epoch 1 PSNR: 15.670980453491211 sigma_y: 1.7000000000000002 tau: 1.0
M_diag tensor([1.4377, 0.8848, 0.7411, 0.7444, 0.6643, 1.4721, 0.9852, 1.2165, 1.2756,
        1.2293], device='cuda:0')
epoch 2 PSNR: 19.537769317626953 sigma_y: 1.6471111111111112 tau: 1.0
M_diag tensor([0.6900, 0.6663, 0.8529, 0.8313, 1.1518, 1.0672, 0.9068, 0.9317, 0.6663,
        1.1092], device='cuda:0')
epoch 3 PSNR: 20.607736587524414 sigma_y: 1.5951111111111111 tau: 1.0
M_diag tensor([1.2913, 1.2817, 0.7410, 1.1172, 0.6852, 1.6393, 0.7029, 0.6149, 1.2818,
        1.0842], device='cuda:0')
epoch 4 PSNR: 22.357135772705078 sigma_y: 1.544 tau: 1.0
M_diag tensor([1.4402, 1.3507, 0.8119, 0.7163, 1.4441, 0.7322, 0.6990, 0.7836, 0.6510,
        1.0856], device='cuda:0')
epoch 5 PSNR: 23.573301315307617 sigma_y: 1.493777777777778 tau: 1.0
M_diag tensor([0.9147, 1.6172, 0.7036, 0.9145, 1.3313, 1.2879, 1.4162, 0.7656, 1.4604,
        1.0276], device='cuda:0')
epoch 6 PSNR: 23.246938705444336 sigma_y: 1.4444444444444444 tau: 1.0
M_diag tensor([1.2603, 0.8745, 1.0993, 0.8784, 1.1737, 1.5173, 1.1588, 1.3456, 1.5156,
        0.8209], device='cuda:0')
epoch 7 PSNR: 23.07717514038086 sigma_y: 1.3960000000000004 tau: 0.95
M_diag tensor([0.7458, 0.7752, 0.7940, 0.7925, 1.5785, 0.9446, 1.0941, 1.0274, 0.8393,
        0.6114], device='cuda:0')
epoch 8 PSNR: 24.07367706298828 sigma_y: 1.3484444444444446 tau: 0.7737809374999999
M_diag tensor([0.6941, 0.6475, 0.8426, 1.4222, 0.6903, 1.5114, 0.7203, 1.4487, 1.1611,
        1.2845], device='cuda:0')
epoch 9 PSNR: 24.441665649414062 sigma_y: 1.3017777777777781 tau: 0.7737809374999999
M_diag tensor([0.8542, 1.5695, 1.2794, 1.4193, 1.2855, 1.1079, 1.3179, 0.7444, 0.9647,
        0.8742], device='cuda:0')
epoch 10 PSNR: 24.59552764892578 sigma_y: 1.256 tau: 0.7737809374999999
M_diag tensor([0.6558, 0.7908, 0.9748, 0.8239, 1.0142, 0.7080, 0.6738, 1.6445, 1.0937,
        0.8186], device='cuda:0')
epoch 11 PSNR: 24.541339874267578 sigma_y: 1.2111111111111115 tau: 0.7737809374999999
M_diag tensor([1.0591, 0.6747, 1.5187, 1.2197, 1.3091, 0.8297, 1.4945, 0.7120, 0.6199,
        0.8396], device='cuda:0')
epoch 12 PSNR: 24.489669799804688 sigma_y: 1.1671111111111112 tau: 0.7737809374999999
M_diag tensor([1.1605, 0.7017, 1.1449, 1.1942, 0.7191, 1.2506, 0.8095, 0.6718, 0.9726,
        1.5888], device='cuda:0')
epoch 13 PSNR: 24.50483512878418 sigma_y: 1.1240000000000003 tau: 0.7737809374999999
M_diag tensor([1.1074, 0.9065, 0.9466, 1.1546, 1.0378, 0.6081, 0.7479, 0.7958, 0.6396,
        0.7113], device='cuda:0')
epoch 14 PSNR: 24.45746612548828 sigma_y: 1.081777777777778 tau: 0.7737809374999999
M_diag tensor([0.8873, 1.0630, 1.0567, 0.6686, 0.7878, 0.6592, 1.5274, 0.6379, 1.1674,
        1.1583], device='cuda:0')
epoch 15 PSNR: 24.793983459472656 sigma_y: 1.0404444444444445 tau: 0.6983372960937497
M_diag tensor([1.4779, 0.8323, 1.6034, 0.9022, 1.3552, 0.8372, 1.4266, 1.4009, 1.4946,
        0.6830], device='cuda:0')
epoch 16 PSNR: 25.12777328491211 sigma_y: 1.0 tau: 0.6983372960937497
M_diag tensor([0.7034, 1.4702, 1.2674, 1.2888, 0.7620, 1.3010, 0.6504, 1.3747, 0.8093,
        0.8346], device='cuda:0')
epoch 17 PSNR: 25.149019241333008 sigma_y: 0.9604444444444447 tau: 0.6983372960937497
M_diag tensor([1.6025, 1.1719, 0.9740, 1.0270, 1.3305, 1.3685, 1.1706, 1.4789, 0.7891,
        0.8325], device='cuda:0')
epoch 18 PSNR: 25.4377384185791 sigma_y: 0.9217777777777778 tau: 0.5688000922764596
M_diag tensor([1.3461, 0.6848, 0.8770, 1.4159, 1.1202, 1.1536, 0.6655, 1.2212, 1.5387,
        0.9215], device='cuda:0')
epoch 19 PSNR: 25.40628433227539 sigma_y: 0.8839999999999999 tau: 0.5688000922764596
M_diag tensor([0.8457, 0.7424, 0.7833, 1.1910, 0.6690, 0.7671, 1.6172, 0.6198, 0.6581,
        1.0693], device='cuda:0')
epoch 20 PSNR: 25.842897415161133 sigma_y: 0.8471111111111111 tau: 0.5688000922764596
M_diag tensor([0.6778, 1.5865, 1.3536, 0.9093, 1.4201, 1.0100, 0.6262, 0.6650, 0.7614,
        1.0885], device='cuda:0')
epoch 21 PSNR: 26.32848358154297 sigma_y: 0.8111111111111112 tau: 0.5688000922764596
M_diag tensor([0.8809, 0.7055, 1.1637, 0.9016, 1.4461, 1.4511, 0.6097, 1.1038, 1.0095,
        0.6907], device='cuda:0')
epoch 22 PSNR: 26.66773223876953 sigma_y: 0.7760000000000001 tau: 0.5688000922764596
M_diag tensor([1.3868, 0.7456, 0.6785, 0.8166, 1.0319, 1.2967, 0.6578, 1.1197, 0.6658,
        1.4316], device='cuda:0')
epoch 23 PSNR: 26.218040466308594 sigma_y: 0.7417777777777778 tau: 0.5688000922764596
M_diag tensor([0.7075, 1.6428, 0.8942, 0.9668, 0.6260, 1.0495, 0.8928, 1.2125, 1.0389,
        1.2087], device='cuda:0')
epoch 24 PSNR: 26.81871223449707 sigma_y: 0.7084444444444445 tau: 0.5688000922764596
M_diag tensor([1.3595, 0.6214, 1.0175, 0.7984, 1.6116, 1.2299, 1.2609, 0.6336, 0.9496,
        0.7584], device='cuda:0')
epoch 25 PSNR: 27.082839965820312 sigma_y: 0.6759999999999999 tau: 0.5688000922764596
M_diag tensor([0.8106, 1.5105, 1.3632, 0.6828, 1.1379, 1.2329, 0.7326, 0.7529, 1.0337,
        1.1516], device='cuda:0')
epoch 26 PSNR: 27.141578674316406 sigma_y: 0.6444444444444443 tau: 0.5688000922764596
M_diag tensor([0.7085, 0.6505, 0.9748, 0.7672, 0.9856, 0.7449, 0.7847, 1.0064, 0.7658,
        1.5447], device='cuda:0')
epoch 27 PSNR: 27.288639068603516 sigma_y: 0.6137777777777778 tau: 0.5688000922764596
M_diag tensor([0.9472, 1.5358, 0.7226, 0.7587, 0.9009, 0.7268, 0.8663, 0.6785, 0.9448,
        0.7572], device='cuda:0')
epoch 28 PSNR: 27.201305389404297 sigma_y: 0.5840000000000001 tau: 0.5688000922764596
M_diag tensor([0.7193, 0.7845, 0.8363, 0.6234, 1.0337, 1.2956, 0.6162, 0.7277, 1.4545,
        1.0672], device='cuda:0')
epoch 29 PSNR: 27.265552520751953 sigma_y: 0.5551111111111111 tau: 0.48767497911552943
M_diag tensor([1.2438, 0.7460, 0.9277, 0.6946, 0.8678, 0.6373, 1.3577, 1.4810, 1.3293,
        0.9022], device='cuda:0')
epoch 30 PSNR: 27.489898681640625 sigma_y: 0.527111111111111 tau: 0.48767497911552943
M_diag tensor([1.1060, 0.9719, 0.9950, 1.2969, 1.0365, 1.3253, 0.6929, 0.7838, 1.4388,
        1.4201], device='cuda:0')
epoch 31 PSNR: 27.512855529785156 sigma_y: 0.5 tau: 0.46329123015975293
M_diag tensor([0.8293, 0.8058, 1.3535, 0.6832, 0.9478, 1.0373, 1.2935, 1.5631, 1.3085,
        0.8263], device='cuda:0')
epoch 32 PSNR: 27.537309646606445 sigma_y: 0.47377777777777774 tau: 0.46329123015975293
M_diag tensor([1.1284, 1.5590, 1.5303, 0.8341, 1.2686, 1.5980, 1.2934, 0.6978, 1.4972,
        1.1216], device='cuda:0')
epoch 33 PSNR: 27.522199630737305 sigma_y: 0.44844444444444453 tau: 0.46329123015975293
M_diag tensor([0.7455, 0.6933, 0.6738, 1.1772, 1.1944, 1.1060, 1.4127, 0.7172, 0.6254,
        1.5706], device='cuda:0')
epoch 34 PSNR: 27.733474731445312 sigma_y: 0.42399999999999993 tau: 0.46329123015975293
M_diag tensor([0.8121, 0.7096, 0.8696, 0.6231, 0.7561, 0.9670, 1.5035, 1.2222, 0.8402,
        1.5809], device='cuda:0')
epoch 35 PSNR: 27.6607608795166 sigma_y: 0.4004444444444445 tau: 0.44012666865176525
M_diag tensor([1.2230, 0.7291, 0.6443, 1.1937, 1.3613, 0.9996, 0.6456, 1.2065, 1.0413,
        0.8551], device='cuda:0')
epoch 36 PSNR: 27.93511962890625 sigma_y: 0.37777777777777777 tau: 0.44012666865176525
M_diag tensor([0.8628, 0.6672, 0.6981, 1.1468, 1.3913, 0.6555, 1.2012, 1.0076, 0.9933,
        0.7917], device='cuda:0')
epoch 37 PSNR: 27.923938751220703 sigma_y: 0.3560000000000001 tau: 0.44012666865176525
M_diag tensor([1.3631, 1.2674, 0.7084, 0.8769, 0.9307, 0.7993, 1.0793, 1.1419, 1.3794,
        0.9974], device='cuda:0')
epoch 38 PSNR: 28.05323028564453 sigma_y: 0.33511111111111114 tau: 0.3972143184582181
M_diag tensor([0.7007, 1.2909, 0.7311, 1.5720, 1.0087, 0.7971, 0.8931, 0.8558, 1.4657,
        1.0788], device='cuda:0')
epoch 39 PSNR: 28.019569396972656 sigma_y: 0.3151111111111112 tau: 0.37735360253530714
M_diag tensor([1.3729, 1.1942, 0.7712, 1.1035, 0.8608, 1.1491, 0.6165, 1.0334, 1.1215,
        1.1943], device='cuda:0')
epoch 40 PSNR: 28.2218017578125 sigma_y: 0.296 tau: 0.2919890243387723
M_diag tensor([0.8501, 1.4789, 0.7910, 1.0778, 1.1110, 0.6635, 1.1557, 1.2573, 0.6627,
        1.3546], device='cuda:0')
epoch 41 PSNR: 28.461517333984375 sigma_y: 0.2777777777777778 tau: 0.2919890243387723
M_diag tensor([1.0709, 1.1504, 1.3830, 0.9350, 0.7572, 0.9312, 0.8340, 0.9669, 0.6416,
        0.7136], device='cuda:0')
epoch 42 PSNR: 28.45264434814453 sigma_y: 0.2604444444444445 tau: 0.263520094465742
M_diag tensor([1.1436, 0.7600, 1.1491, 1.4600, 1.1684, 0.9394, 0.6176, 0.7275, 0.6743,
        0.9736], device='cuda:0')
epoch 43 PSNR: 28.433948516845703 sigma_y: 0.24400000000000005 tau: 0.2259355409925655
M_diag tensor([0.6215, 0.6672, 1.6044, 0.8295, 0.9580, 1.1286, 0.6320, 1.0124, 1.5761,
        0.7767], device='cuda:0')
epoch 44 PSNR: 28.66397476196289 sigma_y: 0.22844444444444445 tau: 0.2259355409925655
M_diag tensor([1.3700, 0.8945, 0.7287, 1.4585, 1.2328, 0.8132, 1.6089, 0.9851, 0.9807,
        0.9513], device='cuda:0')
epoch 45 PSNR: 28.64801788330078 sigma_y: 0.21377777777777784 tau: 0.2259355409925655
M_diag tensor([1.2219, 0.6267, 0.7415, 1.2422, 0.6095, 0.9018, 0.9119, 0.8943, 0.7602,
        1.3758], device='cuda:0')
epoch 46 PSNR: 28.711164474487305 sigma_y: 0.2 tau: 0.2146387639429372
M_diag tensor([1.3970, 1.0179, 1.4245, 1.2247, 1.5532, 1.1347, 0.6732, 0.9109, 0.6711,
        0.9294], device='cuda:0')
epoch 47 PSNR: 28.767127990722656 sigma_y: 0.1871111111111111 tau: 0.20390682574579033
M_diag tensor([1.1826, 0.8079, 1.0179, 0.8487, 1.4204, 1.2630, 1.4789, 0.8106, 0.9242,
        0.6460], device='cuda:0')
epoch 48 PSNR: 28.9669189453125 sigma_y: 0.17511111111111113 tau: 0.15777921478822676
M_diag tensor([0.7589, 1.3109, 0.8342, 1.0221, 0.6451, 0.6299, 0.6079, 0.8763, 1.1480,
        1.1290], device='cuda:0')
epoch 49 PSNR: 28.87932586669922 sigma_y: 0.16399999999999998 tau: 0.15777921478822676
M_diag tensor([1.0856, 0.8793, 0.9370, 0.7246, 1.5814, 1.1433, 1.5151, 0.6092, 0.7814,
        0.9154], device='cuda:0')
epoch 50 PSNR: 28.985885620117188 sigma_y: 0.1537777777777778 tau: 0.14989025404881542
M_diag tensor([0.8089, 1.5307, 0.9481, 0.6554, 0.7956, 1.0779, 1.5504, 1.3029, 0.7498,
        0.7049], device='cuda:0')
epoch 51 PSNR: 29.05510711669922 sigma_y: 0.14444444444444443 tau: 0.14989025404881542
M_diag tensor([0.8178, 1.1931, 1.4394, 1.5095, 0.6695, 1.3285, 0.7286, 1.0594, 1.4219,
        0.9099], device='cuda:0')
epoch 52 PSNR: 29.14081573486328 sigma_y: 0.136 tau: 0.14989025404881542
M_diag tensor([0.9598, 0.8934, 0.9684, 0.8762, 1.0066, 0.6883, 1.0103, 0.6153, 1.6271,
        1.2203], device='cuda:0')
epoch 53 PSNR: 29.136066436767578 sigma_y: 0.12844444444444444 tau: 0.1352759542790559
M_diag tensor([0.6864, 0.6840, 1.3619, 0.8290, 1.2537, 0.9474, 0.8109, 0.9187, 1.1494,
        0.9901], device='cuda:0')
epoch 54 PSNR: 29.243465423583984 sigma_y: 0.12177777777777779 tau: 0.12208654873684793
M_diag tensor([0.8858, 0.8621, 1.0237, 0.8433, 0.6739, 1.2855, 0.6691, 1.0436, 1.4724,
        0.6935], device='cuda:0')
epoch 55 PSNR: 29.329030990600586 sigma_y: 0.11599999999999999 tau: 0.12208654873684793
M_diag tensor([0.6518, 0.9071, 1.5242, 1.2048, 1.5236, 0.9609, 0.7803, 0.9192, 1.3378,
        1.4509], device='cuda:0')
epoch 56 PSNR: 29.390745162963867 sigma_y: 0.11111111111111113 tau: 0.12208654873684793
M_diag tensor([0.9465, 1.1958, 1.3001, 0.6724, 1.5508, 1.3442, 0.8596, 0.9006, 0.9948,
        0.8390], device='cuda:0')
epoch 57 PSNR: 29.40389633178711 sigma_y: 0.10711111111111112 tau: 0.11018311023500525
M_diag tensor([0.7570, 1.2849, 0.7461, 1.2100, 0.8299, 1.6095, 1.5636, 1.5493, 0.6807,
        0.6424], device='cuda:0')
epoch 58 PSNR: 29.49429702758789 sigma_y: 0.10400000000000001 tau: 0.10467395472325498
M_diag tensor([0.7563, 1.5740, 0.8156, 0.7925, 1.2089, 0.9621, 0.6705, 1.0862, 0.8784,
        0.8225], device='cuda:0')
epoch 59 PSNR: 29.49589729309082 sigma_y: 0.10177777777777779 tau: 0.10467395472325498
M_diag tensor([0.8528, 0.6098, 1.5936, 0.8557, 0.9008, 0.7231, 1.4677, 1.4318, 0.8235,
        1.0410], device='cuda:0')
epoch 60 PSNR: 29.590667724609375 sigma_y: 0.10044444444444445 tau: 0.09944025698709223
M_diag tensor([0.7252, 1.1193, 0.6841, 1.3057, 1.4480, 0.9830, 1.4583, 1.0486, 1.6197,
        1.5103], device='cuda:0')
epoch 61 PSNR: 29.616222381591797 sigma_y: 0.1 tau: 0.09944025698709223
M_diag tensor([0.7720, 1.3836, 1.2833, 1.5022, 1.5249, 1.4823, 1.1618, 1.3054, 1.0302,
        1.1388], device='cuda:0')
epoch 62 PSNR: 29.644166946411133 sigma_y: 0.1 tau: 0.09944025698709223
M_diag tensor([1.2193, 0.6756, 1.5312, 0.7490, 1.1611, 0.7521, 1.0325, 1.1743, 0.9823,
        0.7161], device='cuda:0')
epoch 63 PSNR: 29.69785499572754 sigma_y: 0.1 tau: 0.09944025698709223
M_diag tensor([0.9403, 1.2589, 0.8367, 1.5435, 1.0587, 1.0377, 0.6155, 0.6472, 0.8190,
        1.6295], device='cuda:0')
epoch 64 PSNR: 29.75625228881836 sigma_y: 0.1 tau: 0.08974483193085074
M_diag tensor([0.7395, 0.7787, 1.3416, 0.6913, 0.7368, 0.8764, 1.4533, 1.0818, 1.2878,
        1.5244], device='cuda:0')
epoch 65 PSNR: 29.75979995727539 sigma_y: 0.1 tau: 0.08974483193085074
M_diag tensor([1.1840, 1.2734, 0.9071, 0.9014, 1.2336, 1.1317, 0.7508, 0.6459, 0.8913,
        1.1372], device='cuda:0')
epoch 66 PSNR: 29.75305938720703 sigma_y: 0.1 tau: 0.07309772651287748
M_diag tensor([1.1870, 0.7229, 0.9614, 0.6925, 1.1622, 0.6885, 1.1253, 1.5302, 0.8634,
        0.8851], device='cuda:0')
epoch 67 PSNR: 29.754966735839844 sigma_y: 0.1 tau: 0.07309772651287748
M_diag tensor([0.9656, 0.9980, 1.1439, 1.0276, 1.4099, 0.7740, 1.0342, 1.0196, 1.2957,
        1.4878], device='cuda:0')
epoch 68 PSNR: 29.77587890625 sigma_y: 0.1 tau: 0.07309772651287748
  0%|          | 0/100 [13:03<?, ?it/s]
Traceback (most recent call last):
  File "main_sampling.py", line 1045, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 835, in hmc
    loss_grad = torch.autograd.grad(loss, x_proposal, retain_graph=False)[0]
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/__init__.py", line 436, in grad
    result = _engine_run_backward(
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/autograd/graph.py", line 769, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 227231) is killed by signal: Terminated. 
