nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
M_diag tensor([0.5679, 1.5337, 0.5805, 1.0154, 0.7744, 0.4316, 0.5976, 1.5761, 0.6248,
        0.5321], device='cuda:0')
epoch 1 PSNR: 15.627790451049805 sigma_y: 1.7000000000000002 tau: 1.0
M_diag tensor([2.1937, 0.7527, 0.5511, 0.5590, 0.4715, 2.2820, 1.1332, 1.2877, 1.7224,
        1.8071], device='cuda:0')
epoch 2 PSNR: 19.460660934448242 sigma_y: 1.6471111111111112 tau: 1.0
M_diag tensor([0.4096, 0.9515, 1.1772, 1.3986, 0.4483, 0.4229, 1.4263, 0.8535, 2.4630,
        0.6575], device='cuda:0')
epoch 3 PSNR: 20.427860260009766 sigma_y: 1.5951111111111111 tau: 1.0
M_diag tensor([1.2319, 0.9136, 0.8233, 1.8018, 1.1001, 2.7130, 0.6527, 0.4628, 0.3923,
        0.5158], device='cuda:0')
epoch 4 PSNR: 21.37056541442871 sigma_y: 1.544 tau: 0.95
M_diag tensor([1.4221, 2.2553, 1.7667, 0.9640, 1.0069, 0.4340, 0.8200, 1.7694, 1.9650,
        2.7083], device='cuda:0')
epoch 5 PSNR: 22.161243438720703 sigma_y: 1.493777777777778 tau: 0.95
M_diag tensor([1.4138, 0.9912, 0.8006, 0.9367, 1.1473, 2.5590, 0.3750, 0.9192, 0.3938,
        0.4204], device='cuda:0')
epoch 6 PSNR: 21.250110626220703 sigma_y: 1.4444444444444444 tau: 0.95
M_diag tensor([2.0471, 1.0898, 2.5599, 2.5363, 0.4353, 0.6273, 1.5595, 0.7970, 0.5832,
        2.6229], device='cuda:0')
epoch 7 PSNR: 21.049053192138672 sigma_y: 1.3960000000000004 tau: 0.9025
M_diag tensor([0.3995, 0.8764, 0.9001, 0.9086, 0.7458, 1.8013, 0.4207, 0.9665, 1.9228,
        0.4330], device='cuda:0')
epoch 8 PSNR: 20.63675308227539 sigma_y: 1.3484444444444446 tau: 0.9025
M_diag tensor([2.3445, 0.4973, 1.1497, 0.8387, 1.0266, 1.3766, 1.0111, 2.6498, 2.0497,
        0.5023], device='cuda:0')
epoch 9 PSNR: 20.298282623291016 sigma_y: 1.3017777777777781 tau: 0.9025
M_diag tensor([0.4554, 2.1614, 0.4055, 0.4644, 0.7214, 1.1161, 0.5497, 0.8015, 0.3968,
        0.4982], device='cuda:0')
epoch 10 PSNR: 20.267812728881836 sigma_y: 1.256 tau: 0.9025
M_diag tensor([0.4998, 0.3727, 1.6796, 1.0318, 2.5950, 1.6194, 2.2615, 1.9173, 0.7060,
        0.5777], device='cuda:0')
epoch 11 PSNR: 20.676254272460938 sigma_y: 1.2111111111111115 tau: 0.8573749999999999
M_diag tensor([1.5351, 1.2006, 0.9960, 1.0808, 0.5634, 0.8747, 0.3854, 0.4530, 0.7377,
        2.4414], device='cuda:0')
epoch 12 PSNR: 23.388383865356445 sigma_y: 1.1671111111111112 tau: 0.7350918906249998
M_diag tensor([0.6928, 0.9942, 2.1963, 0.4387, 2.0400, 1.5100, 2.1468, 0.4996, 0.8898,
        0.4167], device='cuda:0')
epoch 13 PSNR: 24.518600463867188 sigma_y: 1.1240000000000003 tau: 0.6983372960937497
M_diag tensor([0.9641, 1.9065, 0.4288, 2.5614, 1.1850, 0.4209, 2.0071, 0.5768, 1.4823,
        0.9747], device='cuda:0')
epoch 14 PSNR: 25.190582275390625 sigma_y: 1.081777777777778 tau: 0.5403600876626365
M_diag tensor([0.7317, 0.6841, 0.7982, 0.9655, 2.3461, 2.5150, 1.2490, 1.9548, 1.1567,
        1.3045], device='cuda:0')
epoch 15 PSNR: 25.198532104492188 sigma_y: 1.0404444444444445 tau: 0.5403600876626365
M_diag tensor([1.2481, 1.0078, 2.3260, 1.9120, 0.4007, 1.6781, 1.5517, 2.5751, 1.1398,
        1.4058], device='cuda:0')
epoch 16 PSNR: 25.6935977935791 sigma_y: 1.0 tau: 0.5403600876626365
M_diag tensor([2.0765, 0.7438, 0.4342, 1.2719, 2.3147, 1.7767, 1.5255, 1.3279, 0.6547,
        0.4369], device='cuda:0')
epoch 17 PSNR: 25.629852294921875 sigma_y: 0.9604444444444447 tau: 0.5403600876626365
M_diag tensor([1.6232, 1.3026, 1.7935, 1.3419, 0.9347, 1.0089, 0.5669, 1.1982, 1.6975,
        1.9929], device='cuda:0')
epoch 18 PSNR: 25.473920822143555 sigma_y: 0.9217777777777778 tau: 0.5403600876626365
M_diag tensor([0.4149, 1.4889, 1.7117, 1.0182, 1.6416, 0.7017, 0.3868, 0.7383, 0.7727,
        0.9525], device='cuda:0')
epoch 19 PSNR: 25.774539947509766 sigma_y: 0.8839999999999999 tau: 0.5403600876626365
M_diag tensor([0.8511, 1.0479, 1.0915, 0.9094, 1.0334, 1.9003, 1.4622, 1.5028, 1.5009,
        0.5907], device='cuda:0')
epoch 20 PSNR: 26.182329177856445 sigma_y: 0.8471111111111111 tau: 0.5403600876626365
M_diag tensor([1.7703, 0.4745, 0.6251, 0.9423, 0.8454, 1.5303, 0.4641, 0.5832, 0.5031,
        2.0310], device='cuda:0')
epoch 21 PSNR: 25.992183685302734 sigma_y: 0.8111111111111112 tau: 0.5403600876626365
M_diag tensor([0.4563, 2.6747, 0.5500, 0.6630, 0.5890, 0.9622, 0.6993, 2.4724, 0.9269,
        1.1946], device='cuda:0')
epoch 22 PSNR: 26.434284210205078 sigma_y: 0.7760000000000001 tau: 0.5403600876626365
M_diag tensor([2.1934, 0.3953, 1.3885, 0.5192, 2.3585, 1.6647, 1.5709, 0.5381, 0.8093,
        0.6285], device='cuda:0')
epoch 23 PSNR: 26.804916381835938 sigma_y: 0.7417777777777778 tau: 0.5403600876626365
M_diag tensor([0.4570, 2.0552, 0.9828, 0.9290, 0.7190, 0.4738, 0.5474, 1.7115, 0.6221,
        2.5781], device='cuda:0')
epoch 24 PSNR: 26.891529083251953 sigma_y: 0.7084444444444445 tau: 0.5403600876626365
M_diag tensor([1.0681, 0.8320, 0.9448, 0.4741, 0.9383, 1.7701, 0.4668, 0.5617, 0.6314,
        0.9581], device='cuda:0')
epoch 25 PSNR: 26.59366798400879 sigma_y: 0.6759999999999999 tau: 0.5403600876626365
M_diag tensor([0.9424, 2.3329, 0.4811, 0.9153, 0.8548, 0.5422, 1.3601, 0.6988, 1.1202,
        0.9271], device='cuda:0')
epoch 26 PSNR: 27.046344757080078 sigma_y: 0.6444444444444443 tau: 0.5403600876626365
M_diag tensor([2.1379, 0.8997, 1.7170, 2.0392, 2.0278, 0.8178, 0.9870, 0.5840, 0.9430,
        1.7625], device='cuda:0')
epoch 27 PSNR: 26.97137451171875 sigma_y: 0.6137777777777778 tau: 0.5403600876626365
M_diag tensor([0.3873, 0.8002, 0.7740, 0.3786, 0.6687, 1.6335, 0.4368, 0.4343, 2.1534,
        0.7131], device='cuda:0')
epoch 28 PSNR: 27.139286041259766 sigma_y: 0.5840000000000001 tau: 0.48767497911552943
M_diag tensor([1.3956, 0.7129, 0.7056, 0.8251, 1.2685, 0.3956, 2.2191, 2.5059, 1.4590,
        0.8186], device='cuda:0')
epoch 29 PSNR: 27.33443832397461 sigma_y: 0.5551111111111111 tau: 0.48767497911552943
M_diag tensor([0.9440, 1.1258, 0.9220, 1.6681, 1.0760, 2.0826, 0.4819, 0.4514, 1.9746,
        2.0589], device='cuda:0')
epoch 30 PSNR: 27.276296615600586 sigma_y: 0.527111111111111 tau: 0.46329123015975293
M_diag tensor([0.4047, 0.4345, 0.3688, 0.5904, 1.6147, 0.8245, 0.6374, 2.3078, 1.0860,
        0.4602], device='cuda:0')
epoch 31 PSNR: 27.615772247314453 sigma_y: 0.5 tau: 0.41812033521917696
M_diag tensor([2.3452, 2.0253, 1.8735, 1.8542, 1.4011, 1.6319, 1.0350, 0.4708, 1.9370,
        2.2224], device='cuda:0')
epoch 32 PSNR: 27.532974243164062 sigma_y: 0.47377777777777774 tau: 0.41812033521917696
M_diag tensor([1.1152, 0.4141, 0.3711, 1.0012, 1.4933, 0.4862, 0.3902, 1.8228, 0.8653,
        0.5592], device='cuda:0')
epoch 33 PSNR: 27.612777709960938 sigma_y: 0.44844444444444453 tau: 0.41812033521917696
M_diag tensor([0.3977, 2.3725, 1.3465, 1.4291, 0.9041, 0.5504, 1.2874, 0.7619, 1.0270,
        1.6662], device='cuda:0')
epoch 34 PSNR: 27.51665496826172 sigma_y: 0.42399999999999993 tau: 0.41812033521917696
M_diag tensor([2.6515, 0.4716, 1.7254, 1.0416, 0.4470, 1.9329, 0.7324, 0.5093, 0.8395,
        0.5622], device='cuda:0')
epoch 35 PSNR: 27.848316192626953 sigma_y: 0.4004444444444445 tau: 0.41812033521917696
M_diag tensor([0.7603, 2.5373, 1.2713, 0.3776, 2.0104, 0.7509, 1.9148, 0.4708, 0.4318,
        2.0286], device='cuda:0')
epoch 36 PSNR: 28.059728622436523 sigma_y: 0.37777777777777777 tau: 0.41812033521917696
M_diag tensor([0.4438, 1.2641, 0.5488, 2.2515, 0.4489, 0.5231, 0.4770, 2.4217, 2.6297,
        1.1107], device='cuda:0')
epoch 37 PSNR: 28.256052017211914 sigma_y: 0.3560000000000001 tau: 0.41812033521917696
M_diag tensor([1.1957, 1.7364, 1.1775, 1.9559, 0.9626, 0.7148, 1.3233, 0.5953, 1.7418,
        0.9770], device='cuda:0')
epoch 38 PSNR: 28.526371002197266 sigma_y: 0.33511111111111114 tau: 0.37735360253530714
M_diag tensor([0.6821, 0.7807, 1.9150, 1.3737, 1.9358, 2.4834, 1.5213, 1.0598, 1.0704,
        0.5020], device='cuda:0')
epoch 39 PSNR: 28.655838012695312 sigma_y: 0.3151111111111112 tau: 0.35848592240854177
M_diag tensor([1.0581, 1.6530, 0.5810, 0.9787, 0.6121, 0.6903, 0.4253, 1.0128, 1.7047,
        1.7050], device='cuda:0')
epoch 40 PSNR: 28.700773239135742 sigma_y: 0.296 tau: 0.3235335449737089
M_diag tensor([0.4766, 1.1404, 2.6544, 0.6068, 0.8696, 0.5780, 0.7581, 2.2036, 1.4324,
        2.0623], device='cuda:0')
epoch 41 PSNR: 28.809127807617188 sigma_y: 0.2777777777777778 tau: 0.3235335449737089
M_diag tensor([1.7043, 0.3701, 0.9958, 2.1918, 1.9487, 1.1960, 2.6150, 0.4017, 0.4678,
        0.8232], device='cuda:0')
epoch 42 PSNR: 28.9027042388916 sigma_y: 0.2604444444444445 tau: 0.30735686772502346
M_diag tensor([0.9035, 0.7399, 1.8179, 1.3072, 0.9572, 0.6809, 0.3711, 0.8283, 0.9556,
        0.9638], device='cuda:0')
epoch 43 PSNR: 28.987804412841797 sigma_y: 0.24400000000000005 tau: 0.2378268852553321
M_diag tensor([0.4152, 2.4575, 1.6950, 0.4082, 1.6444, 0.8177, 2.5634, 0.3966, 0.9631,
        2.0906], device='cuda:0')
epoch 44 PSNR: 28.846641540527344 sigma_y: 0.22844444444444445 tau: 0.2378268852553321
M_diag tensor([0.4677, 1.1322, 0.4839, 2.6889, 1.2062, 1.2196, 1.0943, 1.3440, 0.5288,
        1.6670], device='cuda:0')
epoch 45 PSNR: 29.00853729248047 sigma_y: 0.21377777777777784 tau: 0.2259355409925655
M_diag tensor([0.6447, 1.5852, 0.6881, 0.5025, 0.4663, 1.9637, 0.6787, 0.6693, 1.0782,
        0.4509], device='cuda:0')
epoch 46 PSNR: 29.054224014282227 sigma_y: 0.2 tau: 0.2146387639429372
M_diag tensor([2.6273, 0.5627, 1.4581, 2.0505, 2.5761, 0.9903, 0.4319, 1.1443, 0.5547,
        1.4029], device='cuda:0')
epoch 47 PSNR: 29.335857391357422 sigma_y: 0.1871111111111111 tau: 0.2146387639429372
M_diag tensor([0.4077, 2.3988, 0.7440, 0.6655, 1.4081, 1.6778, 0.8270, 0.5147, 0.4209,
        0.3686], device='cuda:0')
epoch 48 PSNR: 29.516334533691406 sigma_y: 0.17511111111111113 tau: 0.1937114844585008
M_diag tensor([0.5398, 1.5779, 0.7992, 0.5797, 0.7359, 0.9204, 2.6028, 1.7563, 0.4426,
        0.5140], device='cuda:0')
epoch 49 PSNR: 29.532880783081055 sigma_y: 0.16399999999999998 tau: 0.14239574134637464
M_diag tensor([1.4391, 1.3633, 1.9848, 0.9412, 0.5684, 1.8618, 1.8357, 0.5960, 2.6903,
        0.7403], device='cuda:0')
epoch 50 PSNR: 29.581850051879883 sigma_y: 0.1537777777777778 tau: 0.1352759542790559
M_diag tensor([1.0836, 0.5578, 0.8636, 1.9041, 1.5507, 0.7828, 1.6079, 1.1618, 0.5589,
        0.4381], device='cuda:0')
epoch 51 PSNR: 29.646930694580078 sigma_y: 0.14444444444444443 tau: 0.1352759542790559
M_diag tensor([1.9351, 2.0319, 1.3748, 1.1963, 0.5765, 2.0657, 1.4914, 1.3202, 1.3258,
        1.5590], device='cuda:0')
epoch 52 PSNR: 29.711647033691406 sigma_y: 0.136 tau: 0.1352759542790559
M_diag tensor([0.5904, 0.6584, 1.0709, 0.9058, 0.8386, 0.4277, 0.6993, 0.3911, 2.6114,
        1.1194], device='cuda:0')
epoch 53 PSNR: 29.766950607299805 sigma_y: 0.12844444444444444 tau: 0.1352759542790559
M_diag tensor([1.8458, 2.5408, 1.7968, 0.6166, 0.8696, 1.6730, 0.5261, 2.5780, 0.4715,
        0.4732], device='cuda:0')
epoch 54 PSNR: 29.805599212646484 sigma_y: 0.12177777777777779 tau: 0.11018311023500525
M_diag tensor([0.7800, 1.0884, 0.5190, 1.3971, 1.2099, 1.5035, 0.4048, 0.9277, 2.0233,
        0.4798], device='cuda:0')
epoch 55 PSNR: 29.84418487548828 sigma_y: 0.11599999999999999 tau: 0.10467395472325498
M_diag tensor([0.5765, 1.3593, 2.4531, 0.4249, 2.4747, 1.4291, 0.6723, 0.7712, 0.8254,
        1.0583], device='cuda:0')
epoch 56 PSNR: 29.916778564453125 sigma_y: 0.11111111111111113 tau: 0.10467395472325498
M_diag tensor([2.4121, 0.5355, 0.4604, 1.3579, 1.1554, 0.3789, 1.4493, 0.3892, 1.1784,
        0.7367], device='cuda:0')
epoch 57 PSNR: 29.937728881835938 sigma_y: 0.10711111111111112 tau: 0.10467395472325498
M_diag tensor([1.5452, 2.4744, 0.4217, 0.8278, 1.4981, 0.4798, 1.3485, 0.5243, 1.7268,
        0.9628], device='cuda:0')
epoch 58 PSNR: 29.98509407043457 sigma_y: 0.10400000000000001 tau: 0.09446824413773762
M_diag tensor([0.4155, 0.3845, 2.6805, 0.7118, 0.6471, 0.5441, 1.4559, 2.3372, 0.5927,
        1.0657], device='cuda:0')
epoch 59 PSNR: 29.98773193359375 sigma_y: 0.10177777777777779 tau: 0.09446824413773762
M_diag tensor([1.4926, 0.9445, 1.3150, 0.5033, 1.7207, 2.4974, 2.3512, 0.6662, 0.8224,
        1.0676], device='cuda:0')
epoch 60 PSNR: 30.08125114440918 sigma_y: 0.10044444444444445 tau: 0.09446824413773762
M_diag tensor([0.5649, 1.0906, 0.5258, 2.1182, 1.5047, 0.6352, 1.7689, 1.4122, 2.5475,
        2.1820], device='cuda:0')
epoch 61 PSNR: 30.102218627929688 sigma_y: 0.1 tau: 0.09446824413773762
M_diag tensor([0.7651, 0.5585, 1.3232, 1.2692, 0.5443, 2.0727, 0.6801, 1.5823, 1.4448,
        0.5841], device='cuda:0')
epoch 62 PSNR: 30.12436866760254 sigma_y: 0.1 tau: 0.0852575903343082
M_diag tensor([0.3841, 0.4636, 0.6104, 0.4651, 1.7436, 0.6246, 1.8721, 0.5654, 1.1654,
        2.2605], device='cuda:0')
epoch 63 PSNR: 30.158061981201172 sigma_y: 0.1 tau: 0.0852575903343082
M_diag tensor([0.3956, 2.2881, 0.9114, 0.7684, 0.5580, 1.4552, 1.8094, 2.5911, 0.9491,
        1.6335], device='cuda:0')
epoch 64 PSNR: 30.198604583740234 sigma_y: 0.1 tau: 0.08099471081759278
M_diag tensor([2.5713, 0.9747, 1.9576, 0.7402, 0.4276, 1.9848, 0.4124, 0.8145, 2.5140,
        1.1592], device='cuda:0')
epoch 65 PSNR: 30.22329330444336 sigma_y: 0.1 tau: 0.07309772651287748
M_diag tensor([0.7181, 1.4070, 0.8099, 0.7793, 1.6443, 0.8581, 0.5746, 0.3803, 0.6767,
        1.5177], device='cuda:0')
epoch 66 PSNR: 30.20208168029785 sigma_y: 0.1 tau: 0.07309772651287748
M_diag tensor([1.9119, 0.7239, 0.4063, 2.3271, 0.4257, 1.8221, 1.8010, 2.5945, 0.5087,
        0.3726], device='cuda:0')
epoch 67 PSNR: 30.229869842529297 sigma_y: 0.1 tau: 0.0694428401872336
M_diag tensor([0.5946, 1.2699, 0.8599, 1.0477, 2.2934, 1.5707, 0.9308, 0.4074, 1.1598,
        0.6800], device='cuda:0')
epoch 68 PSNR: 30.219375610351562 sigma_y: 0.1 tau: 0.0694428401872336
M_diag tensor([1.3111, 1.8095, 1.5413, 2.1688, 0.9881, 1.9036, 2.4106, 2.6765, 1.3481,
        2.2994], device='cuda:0')
epoch 69 PSNR: 30.245697021484375 sigma_y: 0.1 tau: 0.0694428401872336
M_diag tensor([1.7413, 1.5011, 1.1205, 0.7289, 2.6554, 0.6579, 0.4246, 0.7657, 0.4656,
        0.5247], device='cuda:0')
epoch 70 PSNR: 30.25078773498535 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.7731, 0.4176, 1.0626, 0.4287, 0.3786, 0.4331, 0.5473, 2.0442, 1.8619,
        0.4933], device='cuda:0')
epoch 71 PSNR: 30.27758026123047 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.6205, 0.8431, 0.4207, 1.0236, 2.5026, 1.9165, 2.3221, 1.7054, 1.2117,
        2.0721], device='cuda:0')
epoch 72 PSNR: 30.29058837890625 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.6280, 1.8147, 2.5599, 0.3770, 0.7910, 0.7572, 0.9520, 0.8371, 1.9684,
        1.0361], device='cuda:0')
epoch 73 PSNR: 30.330341339111328 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.9008, 1.4482, 0.4890, 1.8675, 0.4111, 0.9244, 0.7249, 0.7323, 0.8144,
        1.4239], device='cuda:0')
epoch 74 PSNR: 30.326231002807617 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.1336, 1.9527, 1.2638, 2.1853, 2.5226, 1.7175, 0.9402, 1.2754, 1.8674,
        0.4461], device='cuda:0')
epoch 75 PSNR: 30.376197814941406 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.7900, 0.5495, 0.6629, 0.6087, 0.9475, 0.5253, 1.1788, 2.2276, 1.3213,
        2.2255], device='cuda:0')
epoch 76 PSNR: 30.33046531677246 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.4061, 2.0875, 1.9634, 1.5672, 2.5781, 1.5668, 0.4254, 1.1162, 0.5027,
        0.7587], device='cuda:0')
epoch 77 PSNR: 30.3347225189209 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.7346, 0.6290, 1.0785, 0.5978, 1.4733, 0.8835, 1.2061, 2.1644, 0.5843,
        0.4824], device='cuda:0')
epoch 78 PSNR: 30.3220272064209 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.0125, 1.4306, 0.7517, 2.1757, 1.0621, 1.1084, 0.9946, 0.9384, 2.6307,
        0.5412], device='cuda:0')
epoch 79 PSNR: 30.311967849731445 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.6563, 0.4621, 0.5627, 0.5881, 1.2043, 0.6151, 2.3665, 1.2079, 1.4492,
        0.5006], device='cuda:0')
epoch 80 PSNR: 30.322378158569336 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.4696, 0.7081, 1.6698, 0.6220, 1.2862, 0.7915, 0.5488, 1.7449, 0.3851,
        2.4664], device='cuda:0')
epoch 81 PSNR: 30.361042022705078 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.3454, 0.6526, 1.1883, 1.2223, 1.5852, 0.5521, 2.6765, 1.7253, 2.6604,
        0.5046], device='cuda:0')
epoch 82 PSNR: 30.396183013916016 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.6025, 2.4260, 1.8700, 0.8974, 0.6908, 0.3877, 0.9436, 1.7415, 0.6933,
        1.0836], device='cuda:0')
epoch 83 PSNR: 30.380165100097656 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.7174, 1.0644, 1.9619, 0.6521, 0.5124, 1.9425, 1.7055, 0.6670, 2.2927,
        0.5748], device='cuda:0')
epoch 84 PSNR: 30.439838409423828 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.5539, 0.6965, 0.5341, 1.5183, 0.7189, 0.9640, 0.3942, 1.5446, 1.1939,
        1.2043], device='cuda:0')
epoch 85 PSNR: 30.42247772216797 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.3938, 0.8776, 1.9242, 0.7914, 0.5391, 1.7165, 2.6190, 2.0449, 1.8706,
        1.1844], device='cuda:0')
epoch 86 PSNR: 30.42828369140625 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([2.3497, 0.6752, 1.7368, 0.4200, 1.6872, 0.7073, 1.8004, 0.4878, 0.5165,
        0.8894], device='cuda:0')
epoch 87 PSNR: 30.381351470947266 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([0.8833, 1.4358, 0.7880, 2.7099, 0.5735, 0.4461, 0.5776, 1.6961, 0.6309,
        0.4650], device='cuda:0')
epoch 88 PSNR: 30.415056228637695 sigma_y: 0.1 tau: 0.0626721632689783
M_diag tensor([1.6610, 0.9716, 2.6449, 0.4600, 0.3882, 0.6848, 0.9904, 1.5589, 0.4567,
        2.6016], device='cuda:0')
epoch 89 PSNR: 30.390260696411133 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([0.3792, 1.5771, 1.1908, 0.8642, 2.3287, 1.6990, 0.3879, 1.6061, 0.4011,
        0.4971], device='cuda:0')
epoch 90 PSNR: 30.393238067626953 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([2.6276, 0.6328, 0.5677, 0.3903, 0.3867, 0.9338, 0.9290, 0.4174, 1.6522,
        1.9112], device='cuda:0')
epoch 91 PSNR: 30.42953872680664 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([0.6371, 0.9880, 2.3843, 0.3843, 0.4148, 1.9067, 1.4463, 0.9188, 0.6997,
        0.9492], device='cuda:0')
epoch 92 PSNR: 30.4685001373291 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([1.2514, 0.7854, 0.4507, 2.4271, 0.6003, 0.6513, 0.7868, 0.9401, 1.4678,
        0.8691], device='cuda:0')
epoch 93 PSNR: 30.490209579467773 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([1.9326, 0.5303, 0.6198, 0.7532, 0.6536, 0.7859, 0.8144, 0.7156, 0.6147,
        1.6873], device='cuda:0')
epoch 94 PSNR: 30.516075134277344 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([0.6411, 1.7176, 0.8959, 2.4012, 1.8343, 2.0712, 1.4570, 0.3849, 0.4507,
        0.8980], device='cuda:0')
epoch 95 PSNR: 30.526878356933594 sigma_y: 0.1 tau: 0.059538555105529384
M_diag tensor([1.0514, 1.2687, 1.7542, 1.2363, 0.4898, 0.5176, 0.6366, 0.6253, 2.0031,
        1.1693], device='cuda:0')
epoch 96 PSNR: 30.540019989013672 sigma_y: 0.1 tau: 0.05656162735025291
M_diag tensor([1.3152, 1.3394, 1.7933, 0.6108, 0.5240, 2.4373, 0.6912, 2.3975, 1.9141,
        2.0077], device='cuda:0')
epoch 97 PSNR: 30.499187469482422 sigma_y: 0.1 tau: 0.05656162735025291
M_diag tensor([0.7863, 0.4735, 0.6639, 0.6960, 2.4125, 0.9231, 1.3004, 0.7348, 1.1610,
        1.6514], device='cuda:0')
epoch 98 PSNR: 30.558717727661133 sigma_y: 0.1 tau: 0.05656162735025291
M_diag tensor([1.5157, 0.5232, 2.1363, 0.6044, 1.6024, 0.6430, 2.0675, 0.5573, 1.5296,
        0.9691], device='cuda:0')
epoch 99 PSNR: 30.53802490234375 sigma_y: 0.1 tau: 0.05656162735025291
M_diag tensor([0.4489, 0.7596, 0.5525, 0.6059, 0.8762, 0.4040, 0.8004, 1.2669, 0.9239,
        2.1966], device='cuda:0')
epoch 100 PSNR: 30.53382682800293 sigma_y: 0.1 tau: 0.05656162735025291
main_sampling.py:521: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  LPIPS = loss_fn_vgg(2*orig-1.0, 2*torch.tensor(x[j]).to(torch.float32).cuda()-1.0)[0,0,0,0]
PSNR:30.4554 (0.0645), SSIM:0.80626 (0.00170), LPIPS:0.24194 (0.00176):   0%|          | 0/100 [16:56<?, ?it/s]PSNR:30.4554 (0.0645), SSIM:0.80626 (0.00170), LPIPS:0.24194 (0.00176):   1%|          | 1/100 [16:56<27:57:19, 1016.56s/it]M_diag tensor([2.1263, 0.7175, 2.6652, 0.7478, 0.6461, 1.0272, 0.4540, 2.2308, 1.9445,
        1.4850], device='cuda:0')
epoch 1 PSNR: 15.901660919189453 sigma_y: 1.7000000000000002 tau: 1.0
PSNR:30.4554 (0.0645), SSIM:0.80626 (0.00170), LPIPS:0.24194 (0.00176):   1%|          | 1/100 [17:02<28:07:01, 1022.44s/it]
Traceback (most recent call last):
  File "main_sampling.py", line 1045, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 833, in hmc
    xt = iterative_sampling(x_proposal, n, b, seq, seq_next, algo, opt, y_0, tqdm_disable=True).clip(-1, 1)
  File "main_sampling.py", line 909, in iterative_sampling
    at = compute_alpha(b, t.long())
  File "main_sampling.py", line 71, in compute_alpha
    beta = torch.cat([torch.zeros(1).to(beta.device), beta], dim=0)
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 224710) is killed by signal: Terminated. 
