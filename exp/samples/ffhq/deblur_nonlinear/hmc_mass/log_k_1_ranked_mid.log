nohup: 忽略输入
Dataset has size 100
Start from 0
  0%|          | 0/100 [00:00<?, ?it/s]Setting up [LPIPS] perceptual loss: trunk [vgg], v[0.1], spatial [off]
Loading model from: /root/.local/lib/python3.8/site-packages/lpips/weights/v0.1/vgg.pth
epoch 1 PSNR: 15.668148040771484 sigma_y: 1.7000000000000002 tau: 1.0
epoch 2 PSNR: 19.021526336669922 sigma_y: 1.6471111111111112 tau: 1.0
epoch 3 PSNR: 20.24835777282715 sigma_y: 1.5951111111111111 tau: 1.0
epoch 4 PSNR: 22.235538482666016 sigma_y: 1.544 tau: 1.0
epoch 5 PSNR: 23.95876121520996 sigma_y: 1.493777777777778 tau: 1.0
epoch 6 PSNR: 24.418903350830078 sigma_y: 1.4444444444444444 tau: 1.0
epoch 7 PSNR: 24.900272369384766 sigma_y: 1.3960000000000004 tau: 1.0
epoch 8 PSNR: 25.522647857666016 sigma_y: 1.3484444444444446 tau: 1.0
epoch 9 PSNR: 25.49620819091797 sigma_y: 1.3017777777777781 tau: 1.0
epoch 10 PSNR: 25.585948944091797 sigma_y: 1.256 tau: 1.0
epoch 11 PSNR: 25.75341796875 sigma_y: 1.2111111111111115 tau: 0.9025
epoch 12 PSNR: 25.834972381591797 sigma_y: 1.1671111111111112 tau: 0.9025
epoch 13 PSNR: 25.83930778503418 sigma_y: 1.1240000000000003 tau: 0.9025
epoch 14 PSNR: 25.42865562438965 sigma_y: 1.081777777777778 tau: 0.7737809374999999
epoch 15 PSNR: 26.155715942382812 sigma_y: 1.0404444444444445 tau: 0.7737809374999999
epoch 16 PSNR: 26.14553451538086 sigma_y: 1.0 tau: 0.7737809374999999
epoch 17 PSNR: 26.50818634033203 sigma_y: 0.9604444444444447 tau: 0.7737809374999999
epoch 18 PSNR: 26.8291015625 sigma_y: 0.9217777777777778 tau: 0.7737809374999999
epoch 19 PSNR: 26.520828247070312 sigma_y: 0.8839999999999999 tau: 0.7737809374999999
epoch 20 PSNR: 26.298648834228516 sigma_y: 0.8471111111111111 tau: 0.7737809374999999
epoch 21 PSNR: 26.75783348083496 sigma_y: 0.8111111111111112 tau: 0.7737809374999999
epoch 22 PSNR: 26.338415145874023 sigma_y: 0.7760000000000001 tau: 0.7737809374999999
epoch 23 PSNR: 26.610689163208008 sigma_y: 0.7417777777777778 tau: 0.6983372960937497
epoch 24 PSNR: 26.780622482299805 sigma_y: 0.7084444444444445 tau: 0.5987369392383786
epoch 25 PSNR: 26.919631958007812 sigma_y: 0.6759999999999999 tau: 0.5403600876626365
epoch 26 PSNR: 27.335216522216797 sigma_y: 0.6444444444444443 tau: 0.5403600876626365
epoch 27 PSNR: 26.777271270751953 sigma_y: 0.6137777777777778 tau: 0.5403600876626365
epoch 28 PSNR: 27.17372703552246 sigma_y: 0.5840000000000001 tau: 0.5133420832795047
epoch 29 PSNR: 27.113910675048828 sigma_y: 0.5551111111111111 tau: 0.5133420832795047
epoch 30 PSNR: 27.414438247680664 sigma_y: 0.527111111111111 tau: 0.41812033521917696
epoch 31 PSNR: 27.46767807006836 sigma_y: 0.5 tau: 0.3972143184582181
epoch 32 PSNR: 27.5460147857666 sigma_y: 0.47377777777777774 tau: 0.3972143184582181
epoch 33 PSNR: 27.617572784423828 sigma_y: 0.44844444444444453 tau: 0.3972143184582181
epoch 34 PSNR: 27.837312698364258 sigma_y: 0.42399999999999993 tau: 0.3972143184582181
epoch 35 PSNR: 28.002891540527344 sigma_y: 0.4004444444444445 tau: 0.3972143184582181
epoch 36 PSNR: 27.834564208984375 sigma_y: 0.37777777777777777 tau: 0.35848592240854177
epoch 37 PSNR: 27.906147003173828 sigma_y: 0.3560000000000001 tau: 0.2919890243387723
epoch 38 PSNR: 28.119237899780273 sigma_y: 0.33511111111111114 tau: 0.2919890243387723
epoch 39 PSNR: 28.118228912353516 sigma_y: 0.3151111111111112 tau: 0.2919890243387723
epoch 40 PSNR: 28.206008911132812 sigma_y: 0.296 tau: 0.2919890243387723
epoch 41 PSNR: 28.461267471313477 sigma_y: 0.2777777777777778 tau: 0.2919890243387723
epoch 42 PSNR: 28.54092025756836 sigma_y: 0.2604444444444445 tau: 0.2919890243387723
epoch 43 PSNR: 28.684349060058594 sigma_y: 0.24400000000000005 tau: 0.2146387639429372
epoch 44 PSNR: 28.750829696655273 sigma_y: 0.22844444444444445 tau: 0.2146387639429372
epoch 45 PSNR: 28.737546920776367 sigma_y: 0.21377777777777784 tau: 0.2146387639429372
epoch 46 PSNR: 28.854244232177734 sigma_y: 0.2 tau: 0.18402591023557577
epoch 47 PSNR: 28.853303909301758 sigma_y: 0.1871111111111111 tau: 0.18402591023557577
epoch 48 PSNR: 28.957502365112305 sigma_y: 0.17511111111111113 tau: 0.18402591023557577
epoch 49 PSNR: 28.948862075805664 sigma_y: 0.16399999999999998 tau: 0.16608338398760714
epoch 50 PSNR: 29.067916870117188 sigma_y: 0.1537777777777778 tau: 0.14239574134637464
epoch 51 PSNR: 29.055904388427734 sigma_y: 0.14444444444444443 tau: 0.1285121565651031
epoch 52 PSNR: 29.153472900390625 sigma_y: 0.136 tau: 0.1285121565651031
epoch 53 PSNR: 29.338497161865234 sigma_y: 0.12844444444444444 tau: 0.1285121565651031
epoch 54 PSNR: 29.321348190307617 sigma_y: 0.12177777777777779 tau: 0.09944025698709223
epoch 55 PSNR: 29.31793975830078 sigma_y: 0.11599999999999999 tau: 0.09944025698709223
epoch 56 PSNR: 29.400428771972656 sigma_y: 0.11111111111111113 tau: 0.09944025698709223
epoch 57 PSNR: 29.422597885131836 sigma_y: 0.10711111111111112 tau: 0.09944025698709223
epoch 58 PSNR: 29.46169090270996 sigma_y: 0.10400000000000001 tau: 0.09944025698709223
epoch 59 PSNR: 29.507713317871094 sigma_y: 0.10177777777777779 tau: 0.09944025698709223
epoch 60 PSNR: 29.499359130859375 sigma_y: 0.10044444444444445 tau: 0.09944025698709223
epoch 61 PSNR: 29.590301513671875 sigma_y: 0.1 tau: 0.09944025698709223
epoch 62 PSNR: 29.590177536010742 sigma_y: 0.1 tau: 0.09944025698709223
epoch 63 PSNR: 29.633634567260742 sigma_y: 0.1 tau: 0.09944025698709223
epoch 64 PSNR: 29.663700103759766 sigma_y: 0.1 tau: 0.08974483193085074
epoch 65 PSNR: 29.708995819091797 sigma_y: 0.1 tau: 0.08974483193085074
epoch 66 PSNR: 29.71715545654297 sigma_y: 0.1 tau: 0.08974483193085074
epoch 67 PSNR: 29.696151733398438 sigma_y: 0.1 tau: 0.08974483193085074
epoch 68 PSNR: 29.734907150268555 sigma_y: 0.1 tau: 0.08974483193085074
epoch 69 PSNR: 29.762222290039062 sigma_y: 0.1 tau: 0.08974483193085074
epoch 70 PSNR: 29.754329681396484 sigma_y: 0.1 tau: 0.08974483193085074
epoch 71 PSNR: 29.76990509033203 sigma_y: 0.1 tau: 0.08974483193085074
epoch 72 PSNR: 29.825942993164062 sigma_y: 0.1 tau: 0.08974483193085074
epoch 73 PSNR: 29.846481323242188 sigma_y: 0.1 tau: 0.08974483193085074
epoch 74 PSNR: 29.838294982910156 sigma_y: 0.1 tau: 0.08974483193085074
epoch 75 PSNR: 29.848501205444336 sigma_y: 0.1 tau: 0.08974483193085074
epoch 76 PSNR: 29.80975341796875 sigma_y: 0.1 tau: 0.08974483193085074
epoch 77 PSNR: 29.857797622680664 sigma_y: 0.1 tau: 0.0852575903343082
epoch 78 PSNR: 29.836040496826172 sigma_y: 0.1 tau: 0.0852575903343082
epoch 79 PSNR: 29.891738891601562 sigma_y: 0.1 tau: 0.0852575903343082
epoch 80 PSNR: 29.919544219970703 sigma_y: 0.1 tau: 0.0852575903343082
epoch 81 PSNR: 29.92842674255371 sigma_y: 0.1 tau: 0.0852575903343082
epoch 82 PSNR: 29.94817543029785 sigma_y: 0.1 tau: 0.0852575903343082
epoch 83 PSNR: 29.901552200317383 sigma_y: 0.1 tau: 0.0852575903343082
epoch 84 PSNR: 29.956323623657227 sigma_y: 0.1 tau: 0.0852575903343082
epoch 85 PSNR: 29.95279312133789 sigma_y: 0.1 tau: 0.0852575903343082
epoch 86 PSNR: 29.97262954711914 sigma_y: 0.1 tau: 0.0852575903343082
epoch 87 PSNR: 30.049245834350586 sigma_y: 0.1 tau: 0.0852575903343082
epoch 88 PSNR: 30.009777069091797 sigma_y: 0.1 tau: 0.0852575903343082
epoch 89 PSNR: 30.041595458984375 sigma_y: 0.1 tau: 0.0852575903343082
epoch 90 PSNR: 30.11018943786621 sigma_y: 0.1 tau: 0.0852575903343082
epoch 91 PSNR: 30.168102264404297 sigma_y: 0.1 tau: 0.0852575903343082
epoch 92 PSNR: 30.147096633911133 sigma_y: 0.1 tau: 0.0694428401872336
epoch 93 PSNR: 30.1268310546875 sigma_y: 0.1 tau: 0.0694428401872336
epoch 94 PSNR: 30.17298126220703 sigma_y: 0.1 tau: 0.0659706981778719
epoch 95 PSNR: 30.139503479003906 sigma_y: 0.1 tau: 0.0659706981778719
epoch 96 PSNR: 30.222820281982422 sigma_y: 0.1 tau: 0.0659706981778719
epoch 97 PSNR: 30.239917755126953 sigma_y: 0.1 tau: 0.0659706981778719
epoch 98 PSNR: 30.27657699584961 sigma_y: 0.1 tau: 0.059538555105529384
epoch 99 PSNR: 30.240995407104492 sigma_y: 0.1 tau: 0.059538555105529384
epoch 100 PSNR: 30.238418579101562 sigma_y: 0.1 tau: 0.059538555105529384
main_sampling.py:521: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  LPIPS = loss_fn_vgg(2*orig-1.0, 2*torch.tensor(x[j]).to(torch.float32).cuda()-1.0)[0,0,0,0]
PSNR:30.0922 (0.1220), SSIM:0.80310 (0.00190), LPIPS:0.22142 (0.00450):   0%|          | 0/100 [11:32<?, ?it/s]PSNR:30.0922 (0.1220), SSIM:0.80310 (0.00190), LPIPS:0.22142 (0.00450):   1%|          | 1/100 [11:32<19:02:53, 692.66s/it]PSNR:30.0922 (0.1220), SSIM:0.80310 (0.00190), LPIPS:0.22142 (0.00450):   1%|          | 1/100 [11:33<19:03:50, 693.24s/it]
Traceback (most recent call last):
  File "main_sampling.py", line 1037, in <module>
    sample_image(opt=opt, config=config, model_config=model_config, device=device)
  File "main_sampling.py", line 483, in sample_image
    xt = hmc(x, n, b, seq, seq_next, algo, opt, y_0, H_funcs, x_orig)
  File "main_sampling.py", line 833, in hmc
    xt = iterative_sampling(x_proposal, n, b, seq, seq_next, algo, opt, y_0, tqdm_disable=True).clip(-1, 1)
  File "main_sampling.py", line 899, in iterative_sampling
    t = (torch.ones(n) * i).to(xt.device)
  File "/root/miniconda3/envs/NHMC/lib/python3.8/site-packages/torch/utils/data/_utils/signal_handling.py", line 67, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 252475) is killed by signal: Terminated. 
